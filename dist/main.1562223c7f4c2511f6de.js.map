{"version":3,"file":"main.1562223c7f4c2511f6de.js","mappings":"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","sources":["webpack://ignite-fitness/./js/ lazy referencedExports:  namespace object","webpack://ignite-fitness/webpack/bootstrap","webpack://ignite-fitness/webpack/runtime/hasOwnProperty shorthand","webpack://ignite-fitness/./js/app.js"],"sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 776;\nmodule.exports = webpackEmptyAsyncContext;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// Performance-Optimized App.js with Code Splitting\r\n// Heavy modules are loaded dynamically to improve initial load time\r\n\r\n// Initialize logger\r\nconst logger = window.SafeLogger || console;\r\n\r\n// Global variables\r\nlet currentUser = null;\r\nlet isLoggedIn = false;\r\nlet users = {};\r\nlet contextAwareAI = null;\r\nlet seasonalTraining = null;\r\nlet dataStore = null;\r\nlet workoutGenerator = null;\r\nlet patternDetector = null;\r\n\r\n// Module loading cache\r\nconst moduleCache = new Map();\r\nconst loadingStates = new Map();\r\n\r\n/**\r\n * Dynamic module loader with caching and loading states\r\n * @param {string} modulePath - Path to the module\r\n * @param {string} className - Class name to instantiate\r\n * @param {Object} options - Loading options\r\n * @returns {Promise} Promise resolving to module instance\r\n */\r\nasync function loadModule(modulePath, className, options = {}) {\r\n  const cacheKey = `${modulePath}:${className}`;\r\n\r\n  // Return cached instance if available\r\n  if (moduleCache.has(cacheKey)) {\r\n    return moduleCache.get(cacheKey);\r\n  }\r\n\r\n  // Check if already loading\r\n  if (loadingStates.has(cacheKey)) {\r\n    return loadingStates.get(cacheKey);\r\n  }\r\n\r\n  // Show loading state if specified\r\n  if (options.showLoading) {\r\n    showLoading(options.loadingMessage || `Loading ${className}...`);\r\n  }\r\n\r\n  try {\r\n    // Create loading promise\r\n    const loadingPromise = (async () => {\r\n      const module = await import(modulePath);\r\n      const instance = new module[className]();\r\n\r\n      // Cache the instance\r\n      moduleCache.set(cacheKey, instance);\r\n\r\n      return instance;\r\n    })();\r\n\r\n    // Store loading promise\r\n    loadingStates.set(cacheKey, loadingPromise);\r\n\r\n    const instance = await loadingPromise;\r\n\r\n    // Clean up loading state\r\n    loadingStates.delete(cacheKey);\r\n\r\n    if (options.showLoading) {\r\n      hideLoading();\r\n    }\r\n\r\n    return instance;\r\n  } catch (error) {\r\n    logger.error('Failed to load module', { modulePath, className, error: error.message, stack: error.stack });\r\n    loadingStates.delete(cacheKey);\r\n\r\n    if (options.showLoading) {\r\n      hideLoading();\r\n    }\r\n\r\n    throw error;\r\n  }\r\n}\r\n\r\n/**\r\n * Load heavy modules on demand\r\n */\r\nasync function _loadHeavyModules() {\r\n  try {\r\n    // Load soccer exercises only when needed\r\n    const soccerExercises = await loadModule(\r\n      './modules/sports/SoccerExercises.js',\r\n      'SoccerExercises',\r\n      { showLoading: true, loadingMessage: 'Loading soccer exercises...' }\r\n    );\r\n\r\n    // Load seasonal programs only when needed\r\n    const seasonalPrograms = await loadModule(\r\n      './modules/sports/SeasonalPrograms.js',\r\n      'SeasonalPrograms',\r\n      { showLoading: true, loadingMessage: 'Loading seasonal programs...' }\r\n    );\r\n\r\n    return { soccerExercises, seasonalPrograms };\r\n  } catch (error) {\r\n    logger.error('Failed to load heavy modules', { error: error.message, stack: error.stack });\r\n    showError(null, 'Failed to load some features. Please refresh the page.');\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * Preload critical modules in background\r\n */\r\nfunction preloadCriticalModules() {\r\n  // Preload modules that are likely to be needed soon\r\n  const criticalModules = [\r\n    { path: './modules/ai/ExpertCoordinator.js', className: 'ExpertCoordinator' },\r\n    { path: './modules/ui/DashboardRenderer.js', className: 'DashboardRenderer' },\r\n    { path: './modules/workout/WorkoutGenerator.js', className: 'WorkoutGenerator' },\r\n  ];\r\n\r\n  criticalModules.forEach(({ path, className }) => {\r\n    loadModule(path, className, { showLoading: false }).catch(error =>\r\n      logger.warn('Preload failed', { className, error: error.message, stack: error.stack })\r\n    );\r\n  });\r\n}\r\n\r\n// Data migration system\r\nfunction migrateUserData() {\r\n  const currentVersion = '2.0';\r\n  const storedVersion = localStorage.getItem('ignitefitness_data_version');\r\n\r\n  if (storedVersion === currentVersion) {\r\n    return; // No migration needed\r\n  }\r\n\r\n  logger.info('Migrating user data', { fromVersion: storedVersion || '1.0', toVersion: currentVersion });\r\n\r\n  // Migrate from version 1.0 to 2.0\r\n  if (!storedVersion || storedVersion === '1.0') {\r\n    migrateFromV1ToV2();\r\n  }\r\n\r\n  // Set new version\r\n  localStorage.setItem('ignitefitness_data_version', currentVersion);\r\n  logger.info('Data migration completed');\r\n}\r\n\r\nfunction migrateFromV1ToV2() {\r\n  try {\r\n    // Migrate users data structure\r\n    const oldUsers = localStorage.getItem('ignitefitness_users');\r\n    if (oldUsers) {\r\n      const usersData = JSON.parse(oldUsers);\r\n      const migratedUsers = {};\r\n\r\n      Object.keys(usersData).forEach(username => {\r\n        const user = usersData[username];\r\n        migratedUsers[username] = {\r\n          version: '2.0',\r\n          username,\r\n          password: user.password,\r\n          athleteName: user.athleteName,\r\n          personalData: user.personalData || {},\r\n          goals: user.goals || {},\r\n          workoutSchedule: user.workoutSchedule || {},\r\n          sessions: user.sessions || [],\r\n          preferences: user.preferences || {},\r\n          lastSync: user.lastSync || Date.now(),\r\n          createdAt: user.createdAt || new Date().toISOString(),\r\n          updatedAt: new Date().toISOString(),\r\n        };\r\n      });\r\n\r\n      localStorage.setItem('ignitefitness_users', JSON.stringify(migratedUsers));\r\n    }\r\n\r\n    // Migrate other data structures\r\n    migrateStravaData();\r\n    migrateWorkoutData();\r\n  } catch (error) {\r\n    logger.error('Error during data migration', { error: error.message, stack: error.stack });\r\n    // Continue with app initialization even if migration fails\r\n  }\r\n}\r\n\r\nfunction migrateStravaData() {\r\n  // Migrate Strava tokens to new format\r\n  const accessToken = localStorage.getItem('strava_access_token');\r\n  const refreshToken = localStorage.getItem('strava_refresh_token');\r\n  const expiresAt = localStorage.getItem('strava_token_expires');\r\n  const athleteId = localStorage.getItem('strava_athlete_id');\r\n\r\n  if (accessToken && refreshToken) {\r\n    const stravaData = {\r\n      access_token: accessToken,\r\n      refresh_token: refreshToken,\r\n      expires_at: parseInt(expiresAt) || 0,\r\n      athlete_id: athleteId,\r\n      last_updated: Date.now(),\r\n    };\r\n\r\n    localStorage.setItem('ignitefitness_strava_data', JSON.stringify(stravaData));\r\n\r\n    // Clean up old keys\r\n    localStorage.removeItem('strava_access_token');\r\n    localStorage.removeItem('strava_refresh_token');\r\n    localStorage.removeItem('strava_token_expires');\r\n    localStorage.removeItem('strava_athlete_id');\r\n  }\r\n}\r\n\r\nfunction migrateWorkoutData() {\r\n  // Migrate any old workout data to new format\r\n  const oldWorkouts = localStorage.getItem('ignitefitness_workouts');\r\n  if (oldWorkouts) {\r\n    try {\r\n      const workouts = JSON.parse(oldWorkouts);\r\n      // Convert to new format if needed\r\n      localStorage.setItem(\r\n        'ignitefitness_workout_data',\r\n        JSON.stringify({\r\n          workouts,\r\n          version: '2.0',\r\n          last_updated: Date.now(),\r\n        })\r\n      );\r\n      localStorage.removeItem('ignitefitness_workouts');\r\n    } catch (error) {\r\n      logger.error('Error migrating workout data', { error: error.message, stack: error.stack });\r\n    }\r\n  }\r\n}\r\n\r\n// Standardized data storage functions\r\nfunction saveUserDataToStorage(userId, data) {\r\n  if (!users[userId]) {\r\n    users[userId] = {\r\n      version: '2.0',\r\n      username: userId,\r\n      createdAt: new Date().toISOString(),\r\n      updatedAt: new Date().toISOString(),\r\n    };\r\n  }\r\n\r\n  // Merge new data with existing user data\r\n  users[userId] = {\r\n    ...users[userId],\r\n    ...data,\r\n    updatedAt: new Date().toISOString(),\r\n  };\r\n\r\n  localStorage.setItem('ignitefitness_users', JSON.stringify(users));\r\n}\r\n\r\nfunction _getUserDataFromStorage(userId) {\r\n  return users[userId] || null;\r\n}\r\n\r\nfunction _saveAppData(key, data) {\r\n  const appData = {\r\n    version: '2.0',\r\n    data,\r\n    last_updated: Date.now(),\r\n  };\r\n  localStorage.setItem(`ignitefitness_${key}`, JSON.stringify(appData));\r\n}\r\n\r\nfunction _getAppData(key) {\r\n  const stored = localStorage.getItem(`ignitefitness_${key}`);\r\n  if (stored) {\r\n    try {\r\n      const parsed = JSON.parse(stored);\r\n      return parsed.data;\r\n    } catch (error) {\r\n      logger.error('Error parsing app data', { key, error: error.message, stack: error.stack });\r\n      return null;\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\n// Initialize when DOM is loaded\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n  logger.info('Ignite Fitness App Starting');\r\n\r\n  // Run data migration first\r\n  migrateUserData();\r\n\r\n  // Check if user is already logged in\r\n  const savedUser = localStorage.getItem('ignitefitness_current_user');\r\n  if (savedUser) {\r\n    currentUser = savedUser;\r\n    isLoggedIn = true;\r\n  }\r\n\r\n  // Load users from localStorage\r\n  const savedUsers = localStorage.getItem('ignitefitness_users');\r\n  if (savedUsers) {\r\n    try {\r\n      users = JSON.parse(savedUsers);\r\n    } catch (error) {\r\n      logger.error('Error parsing saved users', { error: error.message, stack: error.stack });\r\n      users = {};\r\n    }\r\n  }\r\n\r\n  // Initialize core systems with dynamic loading\r\n  initializeCoreSystems();\r\n\r\n  // Preload critical modules in background\r\n  preloadCriticalModules();\r\n\r\n  // Add workout styles\r\n  addWorkoutStyles();\r\n\r\n  // Show appropriate UI\r\n  if (isLoggedIn && currentUser) {\r\n    showUserDashboard();\r\n    loadUserData();\r\n    updateSeasonalPhaseDisplay();\r\n    checkStravaConnection();\r\n    updateSyncStatus();\r\n    loadRecentWorkouts();\r\n  } else {\r\n    showLoginForm();\r\n  }\r\n\r\n  // Handle Enter key in AI chat input\r\n  const aiInput = document.getElementById('aiChatInput');\r\n  if (aiInput) {\r\n    aiInput.addEventListener('keypress', e => {\r\n      if (e.key === 'Enter') {\r\n        sendToAI();\r\n      }\r\n    });\r\n  }\r\n\r\n  logger.info('Ignite Fitness App Ready');\r\n});\r\n\r\n// Simple hash function for password hashing\r\nfunction simpleHash(str) {\r\n  let hash = 0;\r\n  if (str.length === 0) {\r\n    return hash;\r\n  }\r\n  for (let i = 0; i < str.length; i++) {\r\n    const char = str.charCodeAt(i);\r\n    hash = (hash << 5) - hash + char;\r\n    hash = hash & hash;\r\n  }\r\n  return Math.abs(hash).toString(16);\r\n}\r\n\r\n// Authentication Functions\r\nfunction _login() {\r\n  const username = document.getElementById('loginUsername').value;\r\n  const password = document.getElementById('loginPassword').value;\r\n  const errorDiv = document.getElementById('loginError');\r\n\r\n  if (!username || !password) {\r\n    showError(errorDiv, 'Please enter both username and password');\r\n    return;\r\n  }\r\n\r\n  // Check if user exists and verify password hash\r\n  if (users[username] && users[username].passwordHash) {\r\n    const passwordHash = simpleHash(password);\r\n    if (users[username].passwordHash === passwordHash) {\r\n      currentUser = username;\r\n      isLoggedIn = true;\r\n      localStorage.setItem('ignitefitness_current_user', username);\r\n      localStorage.setItem('ignitefitness_login_time', Date.now().toString());\r\n      showSuccess('Login successful!');\r\n      showUserDashboard();\r\n      loadUserData();\r\n    } else {\r\n      showError(errorDiv, 'Invalid username or password');\r\n    }\r\n  } else {\r\n    showError(errorDiv, 'User not found. Please register first.');\r\n  }\r\n}\r\n\r\nfunction _register() {\r\n  const username = document.getElementById('regUsername').value;\r\n  const password = document.getElementById('regPassword').value;\r\n  const confirmPassword = document.getElementById('regConfirmPassword').value;\r\n  const athleteName = document.getElementById('regAthleteName').value;\r\n  const errorDiv = document.getElementById('registerError');\r\n\r\n  if (!username || !password || !athleteName) {\r\n    showError(errorDiv, 'Please fill in all fields');\r\n    return;\r\n  }\r\n\r\n  if (password !== confirmPassword) {\r\n    showError(errorDiv, 'Passwords do not match');\r\n    return;\r\n  }\r\n\r\n  if (users[username]) {\r\n    showError(errorDiv, 'Username already exists');\r\n    return;\r\n  }\r\n\r\n  if (password.length < 6) {\r\n    showError(errorDiv, 'Password must be at least 6 characters long');\r\n    return;\r\n  }\r\n\r\n  // Create new user with hashed password\r\n  users[username] = {\r\n    passwordHash: simpleHash(password),\r\n    athleteName,\r\n    personalData: {},\r\n    goals: {},\r\n    wearableSettings: {},\r\n    workoutPlan: null,\r\n    data: {\r\n      workouts: [],\r\n      soccerSessions: [],\r\n      recoveryData: [],\r\n      stravaData: [],\r\n      sleepData: [],\r\n    },\r\n    createdAt: Date.now(),\r\n    lastLogin: null,\r\n  };\r\n\r\n  // Save users\r\n  localStorage.setItem('ignitefitness_users', JSON.stringify(users));\r\n\r\n  // Auto-login after registration\r\n  currentUser = username;\r\n  isLoggedIn = true;\r\n  localStorage.setItem('ignitefitness_current_user', username);\r\n  showSuccess('Registration successful! Welcome to Ignite Fitness!');\r\n  showUserDashboard();\r\n  hideRegisterForm();\r\n  loadUserData();\r\n}\r\n\r\nfunction _resetPassword() {\r\n  const username = document.getElementById('resetUsername').value;\r\n  const athleteName = document.getElementById('resetAthleteName').value;\r\n  const newPassword = document.getElementById('newPassword').value;\r\n  const confirmPassword = document.getElementById('confirmNewPassword').value;\r\n  const errorDiv = document.getElementById('resetError');\r\n\r\n  if (!username || !athleteName || !newPassword || !confirmPassword) {\r\n    showError(errorDiv, 'Please fill in all fields');\r\n    return;\r\n  }\r\n\r\n  if (newPassword !== confirmPassword) {\r\n    showError(errorDiv, 'Passwords do not match');\r\n    return;\r\n  }\r\n\r\n  if (newPassword.length < 6) {\r\n    showError(errorDiv, 'Password must be at least 6 characters long');\r\n    return;\r\n  }\r\n\r\n  // Verify user exists and athlete name matches\r\n  if (users[username] && users[username].athleteName === athleteName) {\r\n    // Update password hash\r\n    users[username].passwordHash = simpleHash(newPassword);\r\n    users[username].lastPasswordReset = Date.now();\r\n\r\n    // Save updated users\r\n    localStorage.setItem('ignitefitness_users', JSON.stringify(users));\r\n\r\n    showSuccess('Password reset successfully! Please login with your new password.');\r\n    hidePasswordReset();\r\n  } else {\r\n    showError(errorDiv, 'Invalid username or athlete name');\r\n  }\r\n}\r\n\r\n// UI Functions\r\nfunction showLoginForm() {\r\n  document.getElementById('loginForm').classList.remove('hidden');\r\n  document.getElementById('userDashboard').classList.add('hidden');\r\n}\r\n\r\nfunction showUserDashboard() {\r\n  document.getElementById('loginForm').classList.add('hidden');\r\n  document.getElementById('userDashboard').classList.remove('hidden');\r\n\r\n  // Update athlete name display\r\n  const athleteNameElement = document.getElementById('currentAthleteName');\r\n  if (athleteNameElement && users[currentUser]) {\r\n    athleteNameElement.textContent = users[currentUser].athleteName || currentUser;\r\n  }\r\n}\r\n\r\nfunction _showPasswordReset() {\r\n  document.getElementById('loginForm').classList.add('hidden');\r\n  document.getElementById('passwordResetForm').classList.remove('hidden');\r\n}\r\n\r\nfunction hidePasswordReset() {\r\n  document.getElementById('passwordResetForm').classList.add('hidden');\r\n  document.getElementById('loginForm').classList.remove('hidden');\r\n}\r\n\r\nfunction _showRegisterForm() {\r\n  document.getElementById('loginForm').classList.add('hidden');\r\n  document.getElementById('registerForm').classList.remove('hidden');\r\n}\r\n\r\nfunction hideRegisterForm() {\r\n  document.getElementById('registerForm').classList.add('hidden');\r\n}\r\n\r\nfunction _hideLoginForm() {\r\n  document.getElementById('loginForm').classList.add('hidden');\r\n}\r\n\r\n// Tab Functions\r\nfunction _showTab(tabName, clickedButton) {\r\n  // Hide all tab contents\r\n  document.querySelectorAll('.tab-content').forEach(tab => {\r\n    tab.classList.add('hidden');\r\n  });\r\n\r\n  // Remove active class from all tab buttons\r\n  document.querySelectorAll('.tab-btn').forEach(btn => {\r\n    btn.classList.remove('active');\r\n  });\r\n\r\n  // Show selected tab content\r\n  const selectedTab = document.getElementById(tabName);\r\n  if (selectedTab) {\r\n    selectedTab.classList.remove('hidden');\r\n  }\r\n\r\n  // Add active class to clicked button\r\n  if (clickedButton) {\r\n    clickedButton.classList.add('active');\r\n  }\r\n}\r\n\r\n// Data Functions\r\nfunction loadUserData() {\r\n  if (!currentUser || !users[currentUser]) {\r\n    return;\r\n  }\r\n\r\n  const user = users[currentUser];\r\n\r\n  // Load personal data\r\n  if (user.personalData) {\r\n    if (user.personalData.age) {\r\n      document.getElementById('age').value = user.personalData.age;\r\n    }\r\n    if (user.personalData.weight) {\r\n      document.getElementById('weight').value = user.personalData.weight;\r\n    }\r\n    if (user.personalData.height) {\r\n      document.getElementById('height').value = user.personalData.height;\r\n    }\r\n    if (user.personalData.experience) {\r\n      document.getElementById('experience').value = user.personalData.experience;\r\n    }\r\n  }\r\n\r\n  // Load goals\r\n  if (user.goals) {\r\n    if (user.goals.primary) {\r\n      const primaryGoal = document.querySelector(\r\n        `input[name=\"primaryGoal\"][value=\"${user.goals.primary}\"]`\r\n      );\r\n      if (primaryGoal) {\r\n        primaryGoal.checked = true;\r\n      }\r\n    }\r\n    if (user.goals.secondary) {\r\n      const secondaryGoal = document.querySelector(\r\n        `input[name=\"secondaryGoal\"][value=\"${user.goals.secondary}\"]`\r\n      );\r\n      if (secondaryGoal) {\r\n        secondaryGoal.checked = true;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction saveUserData() {\r\n  if (!currentUser) {\r\n    return;\r\n  }\r\n  saveUserDataToStorage(currentUser, users[currentUser] || {});\r\n}\r\n\r\nasync function _savePersonalInfo() {\r\n  const saveButton = document.querySelector('button[onclick=\"savePersonalInfo()\"]');\r\n\r\n  try {\r\n    if (!currentUser) {\r\n      showError(null, 'Please log in first');\r\n      return;\r\n    }\r\n\r\n    const age = document.getElementById('age').value;\r\n    const weight = document.getElementById('weight').value;\r\n    const height = document.getElementById('height').value;\r\n    const experience = document.getElementById('experience').value;\r\n\r\n    // Validate input values\r\n    if (!age || !weight || !height || !experience) {\r\n      showError(null, 'Please fill in all fields');\r\n      return;\r\n    }\r\n\r\n    if (isNaN(age) || age < 13 || age > 100) {\r\n      showError(null, 'Please enter a valid age (13-100)');\r\n      return;\r\n    }\r\n\r\n    if (isNaN(weight) || weight < 30 || weight > 300) {\r\n      showError(null, 'Please enter a valid weight (30-300 kg)');\r\n      return;\r\n    }\r\n\r\n    if (isNaN(height) || height < 100 || height > 250) {\r\n      showError(null, 'Please enter a valid height (100-250 cm)');\r\n      return;\r\n    }\r\n\r\n    // Show loading state\r\n    setButtonLoading(saveButton, true, 'Saving...');\r\n\r\n    const personalData = {\r\n      age: parseInt(age),\r\n      weight: parseFloat(weight),\r\n      height: parseInt(height),\r\n      experience,\r\n    };\r\n\r\n    if (!users[currentUser]) {\r\n      users[currentUser] = {};\r\n    }\r\n\r\n    users[currentUser].personalData = personalData;\r\n    saveUserData();\r\n\r\n    // Sync to database\r\n    await saveUserDataToDatabase();\r\n\r\n    showSuccess('Personal information saved!');\r\n  } catch (error) {\r\n    handleError(error, 'savePersonalInfo');\r\n  } finally {\r\n    setButtonLoading(saveButton, false);\r\n  }\r\n}\r\n\r\nasync function _saveGoals() {\r\n  const saveButton = document.querySelector('button[onclick=\"saveGoals()\"]');\r\n\r\n  try {\r\n    if (!currentUser) {\r\n      showError(null, 'Please log in first');\r\n      return;\r\n    }\r\n\r\n    const primaryGoal = document.querySelector('input[name=\"primaryGoal\"]:checked')?.value;\r\n    const secondaryGoal = document.querySelector('input[name=\"secondaryGoal\"]:checked')?.value;\r\n\r\n    if (!primaryGoal) {\r\n      showError(null, 'Please select a primary goal');\r\n      return;\r\n    }\r\n\r\n    // Show loading state\r\n    setButtonLoading(saveButton, true, 'Saving...');\r\n\r\n    const goals = {\r\n      primary: primaryGoal,\r\n      secondary: secondaryGoal,\r\n    };\r\n\r\n    if (!users[currentUser]) {\r\n      users[currentUser] = {};\r\n    }\r\n\r\n    users[currentUser].goals = goals;\r\n    saveUserData();\r\n\r\n    // Sync to database\r\n    await saveUserDataToDatabase();\r\n\r\n    showSuccess('Goals saved!');\r\n  } catch (error) {\r\n    handleError(error, 'saveGoals');\r\n  } finally {\r\n    setButtonLoading(saveButton, false);\r\n  }\r\n}\r\n\r\n// Workout Generator Functions\r\nasync function initializeWorkoutGenerator() {\r\n  try {\r\n    const workoutModule = await loadModule(\r\n      './modules/workout/WorkoutGenerator.js',\r\n      'WorkoutGenerator'\r\n    );\r\n    workoutGenerator = workoutModule;\r\n    logger.info('Workout generator initialized');\r\n  } catch (error) {\r\n    logger.warn('WorkoutGenerator not available', { error: error.message, stack: error.stack });\r\n  }\r\n}\r\n\r\nfunction buildUserProfile() {\r\n  const user = users[currentUser];\r\n  if (!user) {\r\n    return {};\r\n  }\r\n\r\n  return {\r\n    goals: user.goals || {},\r\n    experience: user.personalData?.experience || 'beginner',\r\n    personalData: user.personalData || {},\r\n    currentPhase: seasonalTraining?.getCurrentPhase()?.phase || 'off-season',\r\n    recentWorkouts: user.data?.sessions || [],\r\n    preferences: {\r\n      preferredTimes: [],\r\n      favoriteExercises: [],\r\n      intensityPreference: 'moderate',\r\n      sessionLength: 'medium',\r\n      restDayPattern: {},\r\n    },\r\n  };\r\n}\r\n\r\nfunction displayGeneratedWorkout(workout) {\r\n  const workoutPlanDiv = document.getElementById('workoutPlan');\r\n  if (!workoutPlanDiv) {\r\n    return;\r\n  }\r\n\r\n  const html = `\r\n        <div class=\"workout-plan\">\r\n            <h3>Generated Workout Plan</h3>\r\n            <div class=\"workout-info\">\r\n                <p><strong>Type:</strong> ${workout.type}</p>\r\n                <p><strong>Focus:</strong> ${workout.focus}</p>\r\n                <p><strong>Duration:</strong> ${workout.duration} minutes</p>\r\n            </div>\r\n            \r\n            <div class=\"workout-section\">\r\n                <h4>Warmup (${workout.warmup.duration} minutes)</h4>\r\n                <ul>\r\n                    ${workout.warmup.exercises\r\n                      .map(\r\n                        ex => `\r\n                        <li><strong>${ex.name}:</strong> ${ex.duration} minutes - ${ex.description}</li>\r\n                    `\r\n                      )\r\n                      .join('')}\r\n                </ul>\r\n            </div>\r\n            \r\n            <div class=\"workout-section\">\r\n                <h4>Main Exercises</h4>\r\n                <div class=\"exercises-list\">\r\n                    ${workout.exercises\r\n                      .map(\r\n                        (ex, index) => `\r\n                        <div class=\"exercise-item\">\r\n                            <h5>${index + 1}. ${ex.name}</h5>\r\n                            <div class=\"exercise-details\">\r\n                                <span><strong>Sets:</strong> ${ex.sets}</span>\r\n                                <span><strong>Reps:</strong> ${ex.reps}</span>\r\n                                <span><strong>Weight:</strong> ${ex.weight} lbs</span>\r\n                                <span><strong>RPE:</strong> ${ex.rpe}/10</span>\r\n                                <span><strong>Rest:</strong> ${ex.rest}s</span>\r\n                            </div>\r\n                            ${ex.notes ? `<p class=\"exercise-notes\">${ex.notes}</p>` : ''}\r\n                        </div>\r\n                    `\r\n                      )\r\n                      .join('')}\r\n                </div>\r\n            </div>\r\n            \r\n            <div class=\"workout-section\">\r\n                <h4>Cooldown (${workout.cooldown.duration} minutes)</h4>\r\n                <ul>\r\n                    ${workout.cooldown.exercises\r\n                      .map(\r\n                        ex => `\r\n                        <li><strong>${ex.name}:</strong> ${ex.duration} minutes - ${ex.description}</li>\r\n                    `\r\n                      )\r\n                      .join('')}\r\n                </ul>\r\n            </div>\r\n            \r\n            ${\r\n              workout.notes\r\n                ? `\r\n                <div class=\"workout-notes\">\r\n                    <h4>Notes</h4>\r\n                    <p>${workout.notes}</p>\r\n                </div>\r\n            `\r\n                : ''\r\n            }\r\n        </div>\r\n    `;\r\n\r\n  workoutPlanDiv.innerHTML = html;\r\n}\r\n\r\n// Add CSS for workout display\r\nfunction addWorkoutStyles() {\r\n  const style = document.createElement('style');\r\n  style.textContent = `\r\n        .workout-plan {\r\n            background: #f7fafc;\r\n            border: 1px solid #e2e8f0;\r\n            border-radius: 8px;\r\n            padding: 20px;\r\n            margin: 20px 0;\r\n        }\r\n        \r\n        .workout-info {\r\n            background: white;\r\n            padding: 15px;\r\n            border-radius: 6px;\r\n            margin: 15px 0;\r\n            border-left: 4px solid #4299e1;\r\n        }\r\n        \r\n        .workout-section {\r\n            margin: 20px 0;\r\n        }\r\n        \r\n        .workout-section h4 {\r\n            color: #2d3748;\r\n            margin-bottom: 10px;\r\n            padding-bottom: 5px;\r\n            border-bottom: 2px solid #e2e8f0;\r\n        }\r\n        \r\n        .exercises-list {\r\n            display: flex;\r\n            flex-direction: column;\r\n            gap: 15px;\r\n        }\r\n        \r\n        .exercise-item {\r\n            background: white;\r\n            border: 1px solid #e2e8f0;\r\n            border-radius: 6px;\r\n            padding: 15px;\r\n        }\r\n        \r\n        .exercise-item h5 {\r\n            margin: 0 0 10px 0;\r\n            color: #2d3748;\r\n        }\r\n        \r\n        .exercise-details {\r\n            display: flex;\r\n            flex-wrap: wrap;\r\n            gap: 15px;\r\n            margin: 10px 0;\r\n        }\r\n        \r\n        .exercise-details span {\r\n            background: #edf2f7;\r\n            padding: 4px 8px;\r\n            border-radius: 4px;\r\n            font-size: 14px;\r\n        }\r\n        \r\n        .exercise-notes {\r\n            margin: 10px 0 0 0;\r\n            font-style: italic;\r\n            color: #4a5568;\r\n            font-size: 14px;\r\n        }\r\n        \r\n        .workout-notes {\r\n            background: #fff5f5;\r\n            border: 1px solid #fed7d7;\r\n            border-radius: 6px;\r\n            padding: 15px;\r\n            margin: 15px 0;\r\n        }\r\n        \r\n        .workout-notes h4 {\r\n            color: #742a2a;\r\n            margin: 0 0 10px 0;\r\n        }\r\n        \r\n        .workout-notes p {\r\n            margin: 0;\r\n            color: #742a2a;\r\n        }\r\n    `;\r\n  document.head.appendChild(style);\r\n}\r\n\r\n/**\r\n * Load soccer exercises when needed\r\n */\r\nasync function _loadSoccerExercises() {\r\n  try {\r\n    const soccerModule = await loadModule(\r\n      './modules/sports/SoccerExercises.js',\r\n      'SoccerExercises',\r\n      { showLoading: true, loadingMessage: 'Loading soccer exercises...' }\r\n    );\r\n    return soccerModule;\r\n  } catch (error) {\r\n    logger.error('Failed to load soccer exercises', { error: error.message, stack: error.stack });\r\n    showError(null, 'Soccer exercises not available. Please refresh the page.');\r\n    return null;\r\n  }\r\n}\r\n\r\n/**\r\n * Load seasonal programs when needed\r\n */\r\nasync function _loadSeasonalPrograms() {\r\n  try {\r\n    const seasonalModule = await loadModule(\r\n      './modules/sports/SeasonalPrograms.js',\r\n      'SeasonalPrograms',\r\n      { showLoading: true, loadingMessage: 'Loading seasonal programs...' }\r\n    );\r\n    return seasonalModule;\r\n  } catch (error) {\r\n    logger.error('Failed to load seasonal programs', { error: error.message, stack: error.stack });\r\n    showError(null, 'Seasonal programs not available. Please refresh the page.');\r\n    return null;\r\n  }\r\n}\r\n\r\n// Pattern Detector Functions\r\nasync function initializePatternDetector() {\r\n  try {\r\n    const patternModule = await loadModule('./modules/ai/PatternDetector.js', 'PatternDetector');\r\n    patternDetector = patternModule;\r\n    logger.info('Pattern detector initialized');\r\n  } catch (error) {\r\n    logger.warn('PatternDetector not available', { error: error.message, stack: error.stack });\r\n  }\r\n}\r\n\r\nfunction analyzeUserPatterns() {\r\n  if (!currentUser || !patternDetector) {\r\n    return;\r\n  }\r\n\r\n  const user = users[currentUser];\r\n  if (!user) {\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const userProfile = buildUserProfile();\r\n    const analysis = patternDetector.analyzePatterns(user.data || {}, userProfile);\r\n\r\n    // Store analysis results\r\n    if (!user.analysis) {\r\n      user.analysis = {};\r\n    }\r\n    user.analysis.patterns = analysis.patterns;\r\n    user.analysis.insights = analysis.insights;\r\n    user.analysis.recommendations = analysis.recommendations;\r\n\r\n    // Save updated user data\r\n    saveUserData();\r\n\r\n    logger.info('Pattern analysis completed', { analysis });\r\n    return analysis;\r\n  } catch (error) {\r\n    logger.error('Pattern analysis failed', { error: error.message, stack: error.stack });\r\n    return null;\r\n  }\r\n}\r\n\r\nfunction displayPatternInsights() {\r\n  if (!currentUser || !patternDetector) {\r\n    return;\r\n  }\r\n\r\n  const user = users[currentUser];\r\n  if (!user?.analysis) {\r\n    return;\r\n  }\r\n\r\n  const insights = user.analysis.insights || [];\r\n  const recommendations = user.analysis.recommendations || [];\r\n\r\n  // Create insights display\r\n  const insightsHtml = `\r\n        <div class=\"pattern-insights\">\r\n            <h3>üìä Training Insights</h3>\r\n            ${\r\n              insights.length > 0\r\n                ? `\r\n                <div class=\"insights-list\">\r\n                    ${insights\r\n                      .map(\r\n                        insight => `\r\n                        <div class=\"insight-item ${insight.priority}\">\r\n                            <h4>${insight.type.charAt(0).toUpperCase() + insight.type.slice(1)}</h4>\r\n                            <p>${insight.message}</p>\r\n                        </div>\r\n                    `\r\n                      )\r\n                      .join('')}\r\n                </div>\r\n            `\r\n                : '<p>No insights available yet. Complete more workouts to see patterns.</p>'\r\n            }\r\n            \r\n            ${\r\n              recommendations.length > 0\r\n                ? `\r\n                <h3>üí° Recommendations</h3>\r\n                <div class=\"recommendations-list\">\r\n                    ${recommendations\r\n                      .map(\r\n                        rec => `\r\n                        <div class=\"recommendation-item\">\r\n                            <h4>${rec.type.charAt(0).toUpperCase() + rec.type.slice(1)}</h4>\r\n                            <p><strong>${rec.message}</strong></p>\r\n                            <p class=\"action\">Action: ${rec.action}</p>\r\n                        </div>\r\n                    `\r\n                      )\r\n                      .join('')}\r\n                </div>\r\n            `\r\n                : ''\r\n            }\r\n        </div>\r\n    `;\r\n\r\n  // Find a place to display insights (could be in a modal or dedicated section)\r\n  const insightsContainer = document.getElementById('patternInsights');\r\n  if (insightsContainer) {\r\n    insightsContainer.innerHTML = insightsHtml;\r\n  } else {\r\n    // Create a temporary display\r\n    const tempDiv = document.createElement('div');\r\n    tempDiv.innerHTML = insightsHtml;\r\n    tempDiv.className = 'pattern-insights-modal';\r\n    document.body.appendChild(tempDiv);\r\n\r\n    // Auto-remove after 10 seconds\r\n    setTimeout(() => {\r\n      if (tempDiv.parentNode) {\r\n        tempDiv.parentNode.removeChild(tempDiv);\r\n      }\r\n    }, 10000);\r\n  }\r\n}\r\n\r\n// Add pattern analysis to workout completion\r\nfunction _onWorkoutCompleted(sessionData) {\r\n  if (!currentUser) {\r\n    return;\r\n  }\r\n\r\n  // Add session to user data\r\n  if (!users[currentUser].data) {\r\n    users[currentUser].data = {};\r\n  }\r\n  if (!users[currentUser].data.sessions) {\r\n    users[currentUser].data.sessions = [];\r\n  }\r\n\r\n  users[currentUser].data.sessions.push(sessionData);\r\n  saveUserData();\r\n\r\n  // Trigger pattern analysis\r\n  setTimeout(() => {\r\n    analyzeUserPatterns();\r\n  }, 1000);\r\n}\r\n\r\n// UI Component Functions\r\nfunction updateSyncStatus() {\r\n  const syncStatus = document.getElementById('syncStatus');\r\n  const lastSync = document.getElementById('lastSync');\r\n\r\n  if (syncStatus && lastSync) {\r\n    const lastSyncTime = localStorage.getItem('ignitefitness_last_sync');\r\n    if (lastSyncTime) {\r\n      const syncDate = new Date(parseInt(lastSyncTime));\r\n      lastSync.textContent = `Last sync: ${syncDate.toLocaleString()}`;\r\n      syncStatus.textContent = '‚úÖ Synced';\r\n    } else {\r\n      lastSync.textContent = 'Last sync: Never';\r\n      syncStatus.textContent = 'üîÑ Syncing...';\r\n    }\r\n  }\r\n}\r\n\r\nfunction _manualSync() {\r\n  if (!currentUser) {\r\n    return;\r\n  }\r\n\r\n  const syncStatus = document.getElementById('syncStatus');\r\n  if (syncStatus) {\r\n    syncStatus.textContent = 'üîÑ Syncing...';\r\n  }\r\n\r\n  saveUserDataToDatabase()\r\n    .then(() => {\r\n      updateSyncStatus();\r\n      showSuccess('Data synced successfully!');\r\n    })\r\n    .catch(error => {\r\n      logger.error('Sync failed', { error: error.message, stack: error.stack });\r\n      showError(null, 'Sync failed. Please try again.');\r\n      if (syncStatus) {\r\n        syncStatus.textContent = '‚ùå Sync Failed';\r\n      }\r\n    });\r\n}\r\n\r\nfunction _startWorkout() {\r\n  showSuccess('Workout logging will be implemented in the full version!');\r\n}\r\n\r\nfunction _logQuickWorkout() {\r\n  showSuccess('Quick workout logging will be implemented in the full version!');\r\n}\r\n\r\nfunction _viewProgress() {\r\n  // Show pattern insights\r\n  displayPatternInsights();\r\n  showSuccess('Progress analysis completed!');\r\n}\r\n\r\nfunction updateWorkoutPlanGeneration() {\r\n  const sessionType = document.getElementById('sessionType')?.value || 'Upper Body';\r\n  const duration = parseInt(document.getElementById('workoutDuration')?.value) || 60;\r\n\r\n  // Update the generateWorkoutPlan function to use these values\r\n  if (currentUser && workoutGenerator) {\r\n    const userProfile = buildUserProfile();\r\n\r\n    try {\r\n      const workout = workoutGenerator.generateWorkout(userProfile, sessionType, duration);\r\n      displayGeneratedWorkout(workout);\r\n      showSuccess('Workout plan generated successfully!');\r\n    } catch (error) {\r\n      logger.error('Workout generation failed', { error: error.message, stack: error.stack });\r\n      showError(null, 'Failed to generate workout plan');\r\n    }\r\n  }\r\n}\r\n\r\n// Override the original generateWorkoutPlan function\r\nfunction _generateWorkoutPlan() {\r\n  updateWorkoutPlanGeneration();\r\n}\r\n\r\n// Load recent workouts\r\nfunction loadRecentWorkouts() {\r\n  if (!currentUser) {\r\n    return;\r\n  }\r\n\r\n  const user = users[currentUser];\r\n  const recentWorkoutsList = document.getElementById('recentWorkoutsList');\r\n\r\n  if (!recentWorkoutsList) {\r\n    return;\r\n  }\r\n\r\n  const sessions = user?.data?.sessions || [];\r\n  const recentSessions = sessions.slice(0, 5); // Last 5 sessions\r\n\r\n  if (recentSessions.length === 0) {\r\n    recentWorkoutsList.innerHTML = '<p>No recent workouts found. Start your first workout!</p>';\r\n    return;\r\n  }\r\n\r\n  const workoutsHtml = recentSessions\r\n    .map(session => {\r\n      const date = new Date(session.start_at).toLocaleDateString();\r\n      const duration = session.duration || 'Unknown';\r\n      const exercises = session.exercises?.length || 0;\r\n\r\n      return `\r\n            <div class=\"workout-item\">\r\n                <div class=\"workout-info\">\r\n                    <h6>${session.type || 'Workout'}</h6>\r\n                    <p>${date}</p>\r\n                </div>\r\n                <div class=\"workout-stats\">\r\n                    <span>${duration} min</span>\r\n                    <span>${exercises} exercises</span>\r\n                </div>\r\n            </div>\r\n        `;\r\n    })\r\n    .join('');\r\n\r\n  recentWorkoutsList.innerHTML = workoutsHtml;\r\n}\r\n\r\nfunction _logout() {\r\n  currentUser = null;\r\n  isLoggedIn = false;\r\n  localStorage.removeItem('ignitefitness_current_user');\r\n  showLoginForm();\r\n  showSuccess('Logged out successfully!');\r\n}\r\n\r\n// Utility Functions\r\nfunction showError(element, message) {\r\n  if (element) {\r\n    element.textContent = message;\r\n    element.style.display = 'block';\r\n  }\r\n}\r\n\r\n// Enhanced error handling with user-friendly messages\r\nfunction handleError(error, context = '') {\r\n  logger.error(`Error in ${context}`, { error: error.message, stack: error.stack, context });\r\n\r\n  let userMessage = 'An unexpected error occurred. Please try again.';\r\n\r\n  // Provide more specific error messages based on error type\r\n  if (error.name === 'TypeError') {\r\n    userMessage = 'A data error occurred. Please refresh the page and try again.';\r\n  } else if (error.name === 'ReferenceError') {\r\n    userMessage = 'A system error occurred. Please refresh the page.';\r\n  } else if (error.message.includes('fetch')) {\r\n    userMessage = 'Network error. Please check your connection and try again.';\r\n  } else if (error.message.includes('JSON')) {\r\n    userMessage = 'Data format error. Please refresh the page.';\r\n  } else if (error.message.includes('localStorage')) {\r\n    userMessage = 'Storage error. Please clear your browser data and try again.';\r\n  } else if (error.message.includes('permission')) {\r\n    userMessage = 'Permission denied. Please check your browser settings.';\r\n  } else if (error.message.includes('timeout')) {\r\n    userMessage = 'Request timed out. Please try again.';\r\n  } else if (error.message.includes('unauthorized')) {\r\n    userMessage = 'Authentication required. Please log in again.';\r\n  } else if (error.message.includes('not found')) {\r\n    userMessage = 'Resource not found. Please refresh the page.';\r\n  } else if (error.message.includes('server')) {\r\n    userMessage = 'Server error. Please try again later.';\r\n  }\r\n\r\n  // Show error notification\r\n  showErrorNotification(userMessage, 'error');\r\n\r\n  return userMessage;\r\n}\r\n\r\n// Show error notification\r\nfunction showErrorNotification(message, type = 'error') {\r\n  // Remove existing notifications\r\n  const existing = document.getElementById('error-notification');\r\n  if (existing) {\r\n    existing.remove();\r\n  }\r\n\r\n  const notification = document.createElement('div');\r\n  notification.id = 'error-notification';\r\n  notification.className = `notification ${type}`;\r\n  notification.style.cssText = `\r\n        position: fixed;\r\n        top: 20px;\r\n        right: 20px;\r\n        background: ${type === 'error' ? '#e53e3e' : '#68d391'};\r\n        color: white;\r\n        padding: 15px 20px;\r\n        border-radius: 8px;\r\n        box-shadow: 0 4px 12px rgba(0,0,0,0.3);\r\n        z-index: 10000;\r\n        max-width: 400px;\r\n        font-weight: 500;\r\n        animation: slideIn 0.3s ease;\r\n    `;\r\n\r\n  notification.innerHTML = `\r\n        <div style=\"display: flex; align-items: center; gap: 10px;\">\r\n            <span style=\"font-size: 20px;\">${type === 'error' ? '‚ùå' : '‚úÖ'}</span>\r\n            <span>${message}</span>\r\n            <button onclick=\"this.parentElement.parentElement.remove()\" style=\"\r\n                background: none;\r\n                border: none;\r\n                color: white;\r\n                font-size: 18px;\r\n                cursor: pointer;\r\n                margin-left: auto;\r\n            \">√ó</button>\r\n        </div>\r\n    `;\r\n\r\n  document.body.appendChild(notification);\r\n\r\n  // Auto-remove after 5 seconds\r\n  setTimeout(() => {\r\n    if (notification.parentElement) {\r\n      notification.remove();\r\n    }\r\n  }, 5000);\r\n}\r\n\r\n// Add CSS animation for notifications\r\nif (!document.getElementById('notification-styles')) {\r\n  const style = document.createElement('style');\r\n  style.id = 'notification-styles';\r\n  style.textContent = `\r\n        @keyframes slideIn {\r\n            from { transform: translateX(100%); opacity: 0; }\r\n            to { transform: translateX(0); opacity: 1; }\r\n        }\r\n        .notification {\r\n            animation: slideIn 0.3s ease;\r\n        }\r\n        .loading-spinner {\r\n            display: inline-block;\r\n            width: 20px;\r\n            height: 20px;\r\n            border: 3px solid rgba(255,255,255,.3);\r\n            border-radius: 50%;\r\n            border-top-color: #fff;\r\n            animation: spin 1s ease-in-out infinite;\r\n        }\r\n        @keyframes spin {\r\n            to { transform: rotate(360deg); }\r\n        }\r\n        .loading-overlay {\r\n            position: fixed;\r\n            top: 0;\r\n            left: 0;\r\n            width: 100%;\r\n            height: 100%;\r\n            background: rgba(0,0,0,0.5);\r\n            display: flex;\r\n            justify-content: center;\r\n            align-items: center;\r\n            z-index: 10000;\r\n        }\r\n        .loading-content {\r\n            background: white;\r\n            padding: 30px;\r\n            border-radius: 10px;\r\n            text-align: center;\r\n            box-shadow: 0 4px 20px rgba(0,0,0,0.3);\r\n        }\r\n    `;\r\n  document.head.appendChild(style);\r\n}\r\n\r\n// Loading state management\r\nfunction showLoading(message = 'Loading...') {\r\n  // Remove existing loading overlay\r\n  hideLoading();\r\n\r\n  const overlay = document.createElement('div');\r\n  overlay.id = 'loading-overlay';\r\n  overlay.className = 'loading-overlay';\r\n  overlay.innerHTML = `\r\n        <div class=\"loading-content\">\r\n            <div class=\"loading-spinner\"></div>\r\n            <p style=\"margin: 15px 0 0 0; color: #2d3748; font-weight: 500;\">${message}</p>\r\n        </div>\r\n    `;\r\n\r\n  document.body.appendChild(overlay);\r\n}\r\n\r\nfunction hideLoading() {\r\n  const overlay = document.getElementById('loading-overlay');\r\n  if (overlay) {\r\n    overlay.remove();\r\n  }\r\n}\r\n\r\n// Enhanced button loading state\r\nfunction setButtonLoading(button, loading = true, text = 'Loading...') {\r\n  if (!button) {\r\n    return;\r\n  }\r\n\r\n  if (loading) {\r\n    button.disabled = true;\r\n    button.dataset.originalText = button.textContent;\r\n    button.innerHTML = `<div class=\"loading-spinner\" style=\"margin-right: 8px;\"></div>${text}`;\r\n  } else {\r\n    button.disabled = false;\r\n    button.textContent = button.dataset.originalText || 'Submit';\r\n    delete button.dataset.originalText;\r\n  }\r\n}\r\n\r\nfunction showSuccess(message) {\r\n  // Create or update success notification\r\n  let notification = document.getElementById('success-notification');\r\n  if (!notification) {\r\n    notification = document.createElement('div');\r\n    notification.id = 'success-notification';\r\n    notification.style.cssText = `\r\n            position: fixed;\r\n            top: 20px;\r\n            right: 20px;\r\n            background: #68d391;\r\n            color: white;\r\n            padding: 15px 20px;\r\n            border-radius: 5px;\r\n            z-index: 1000;\r\n            display: none;\r\n        `;\r\n    document.body.appendChild(notification);\r\n  }\r\n\r\n  notification.textContent = message;\r\n  notification.style.display = 'block';\r\n\r\n  // Hide after 3 seconds\r\n  setTimeout(() => {\r\n    notification.style.display = 'none';\r\n  }, 3000);\r\n}\r\n\r\n/**\r\n * Initialize core systems with dynamic loading\r\n */\r\nasync function initializeCoreSystems() {\r\n  try {\r\n    // Initialize AI system\r\n    await initializeAI();\r\n\r\n    // Initialize data store\r\n    await initializeDataStore();\r\n\r\n    // Initialize workout generator\r\n    await initializeWorkoutGenerator();\r\n\r\n    // Initialize pattern detector\r\n    await initializePatternDetector();\r\n\r\n    logger.info('Core systems initialized successfully');\r\n  } catch (error) {\r\n    logger.error('Failed to initialize core systems', { error: error.message, stack: error.stack });\r\n    showError(null, 'Some features may not be available. Please refresh the page.');\r\n  }\r\n}\r\n\r\n// AI System Functions\r\nasync function initializeAI() {\r\n  try {\r\n    const aiModule = await loadModule('./modules/ai/ContextAwareAI.js', 'ContextAwareAI');\r\n    contextAwareAI = aiModule;\r\n    logger.info('AI system initialized');\r\n  } catch (error) {\r\n    logger.warn('ContextAwareAI not available', { error: error.message, stack: error.stack });\r\n  }\r\n}\r\n\r\n// Seasonal Training Functions\r\nasync function _initializeSeasonalTraining() {\r\n  try {\r\n    const seasonalModule = await loadModule(\r\n      './modules/sports/SeasonalTrainingSystem.js',\r\n      'SeasonalTrainingSystem'\r\n    );\r\n    seasonalTraining = seasonalModule;\r\n    seasonalTraining.initialize();\r\n    logger.info('Seasonal training system initialized');\r\n  } catch (error) {\r\n    logger.warn('SeasonalTrainingSystem not available', { error: error.message, stack: error.stack });\r\n  }\r\n}\r\n\r\nfunction updateSeasonalPhaseDisplay() {\r\n  if (!seasonalTraining) {\r\n    return;\r\n  }\r\n\r\n  const phaseInfo = seasonalTraining.getCurrentPhase();\r\n  const phaseNameElement = document.getElementById('currentPhaseName');\r\n  const phaseProgressElement = document.getElementById('phaseProgress');\r\n\r\n  if (phaseNameElement) {\r\n    phaseNameElement.textContent = phaseInfo.details.name;\r\n  }\r\n\r\n  if (phaseProgressElement) {\r\n    const progress = Math.round(phaseInfo.phaseProgress * 100);\r\n    phaseProgressElement.textContent = `${progress}% Complete`;\r\n  }\r\n}\r\n\r\nfunction _showPhaseModal() {\r\n  if (!seasonalTraining) {\r\n    return;\r\n  }\r\n\r\n  const modal = document.getElementById('phaseModal');\r\n  const phaseDetails = document.getElementById('phaseDetails');\r\n  const phaseInfo = seasonalTraining.getCurrentPhase();\r\n\r\n  if (modal && phaseDetails) {\r\n    phaseDetails.innerHTML = generatePhaseDetailsHTML(phaseInfo);\r\n    modal.classList.remove('hidden');\r\n  }\r\n}\r\n\r\nfunction closePhaseModal() {\r\n  const modal = document.getElementById('phaseModal');\r\n  if (modal) {\r\n    modal.classList.add('hidden');\r\n  }\r\n}\r\n\r\nfunction generatePhaseDetailsHTML(phaseInfo) {\r\n  const { details } = phaseInfo;\r\n  const recommendations = seasonalTraining.getPhaseRecommendations();\r\n  const upcomingGames = seasonalTraining.getUpcomingGames(3);\r\n\r\n  let html = `\r\n        <div class=\"phase-detail-item\">\r\n            <h4>Current Phase: ${details.name}</h4>\r\n            <p><strong>Duration:</strong> ${details.duration}</p>\r\n            <p><strong>Focus:</strong> ${details.focus}</p>\r\n            <p><strong>Volume:</strong> ${details.volume}</p>\r\n            <p><strong>Intensity:</strong> ${details.intensity}</p>\r\n            <p><strong>Frequency:</strong> ${details.frequency}</p>\r\n        </div>\r\n        \r\n        <div class=\"phase-detail-item\">\r\n            <h4>Phase Priorities</h4>\r\n            <ul class=\"phase-priorities\">\r\n                ${details.priorities.map(priority => `<li>${priority}</li>`).join('')}\r\n            </ul>\r\n        </div>\r\n        \r\n        <div class=\"phase-detail-item\">\r\n            <h4>Training Adjustments</h4>\r\n            <p><strong>Volume Multiplier:</strong> ${details.adjustments.volumeMultiplier}x</p>\r\n            <p><strong>Intensity Multiplier:</strong> ${details.adjustments.intensityMultiplier}x</p>\r\n            <p><strong>Recovery Days:</strong> ${details.adjustments.recoveryDays} days</p>\r\n            <p><strong>Max Session Duration:</strong> ${details.adjustments.maxSessionDuration} minutes</p>\r\n        </div>\r\n    `;\r\n\r\n  if (recommendations.length > 0) {\r\n    html += `\r\n            <div class=\"phase-detail-item\">\r\n                <h4>Recommendations</h4>\r\n                ${recommendations\r\n                  .map(\r\n                    rec => `\r\n                    <p><strong>${rec.category}:</strong> ${rec.message}</p>\r\n                `\r\n                  )\r\n                  .join('')}\r\n            </div>\r\n        `;\r\n  }\r\n\r\n  if (upcomingGames.length > 0) {\r\n    html += `\r\n            <div class=\"phase-detail-item\">\r\n                <h4>Upcoming Games</h4>\r\n                <div class=\"game-schedule\">\r\n                    ${upcomingGames\r\n                      .map(\r\n                        game => `\r\n                        <div class=\"game-item\">\r\n                            <div>\r\n                                <div class=\"game-date\">${game.date.toLocaleDateString()}</div>\r\n                                <div class=\"game-opponent\">vs ${game.opponent}</div>\r\n                            </div>\r\n                            <div class=\"game-type\">${game.type}</div>\r\n                        </div>\r\n                    `\r\n                      )\r\n                      .join('')}\r\n                </div>\r\n            </div>\r\n        `;\r\n  }\r\n\r\n  return html;\r\n}\r\n\r\nfunction _changePhase() {\r\n  const phases = ['off-season', 'pre-season', 'in-season', 'playoffs'];\r\n  const currentPhase = seasonalTraining.getCurrentPhase().phase;\r\n  const currentIndex = phases.indexOf(currentPhase);\r\n  const nextIndex = (currentIndex + 1) % phases.length;\r\n  const nextPhase = phases[nextIndex];\r\n\r\n  if (seasonalTraining.setPhase(nextPhase)) {\r\n    updateSeasonalPhaseDisplay();\r\n    showSuccess(`Phase changed to ${seasonalTraining.phases[nextPhase].name}`);\r\n    closePhaseModal();\r\n  }\r\n}\r\n\r\nfunction _addGame() {\r\n  // eslint-disable-next-line no-alert\r\n  const opponent = prompt('Enter opponent name:');\r\n  if (!opponent) {\r\n    return;\r\n  }\r\n\r\n  // eslint-disable-next-line no-alert\r\n  const dateStr = prompt('Enter game date (YYYY-MM-DD):');\r\n  if (!dateStr) {\r\n    return;\r\n  }\r\n\r\n  const gameDate = new Date(dateStr);\r\n  if (isNaN(gameDate.getTime())) {\r\n    showError(null, 'Invalid date format');\r\n    return;\r\n  }\r\n\r\n  // eslint-disable-next-line no-alert\r\n  const type = prompt('Enter game type (regular/playoff/championship):') || 'regular';\r\n  // eslint-disable-next-line no-alert\r\n  const location = prompt('Enter location (home/away):') || 'home';\r\n\r\n  seasonalTraining.addGame({\r\n    opponent,\r\n    date: gameDate,\r\n    type,\r\n    location,\r\n  });\r\n\r\n  showSuccess('Game added to schedule');\r\n  closePhaseModal();\r\n}\r\n\r\n// Data Store Functions\r\nasync function initializeDataStore() {\r\n  try {\r\n    const dataStoreModule = await loadModule('./modules/data/DataStore.js', 'DataStore');\r\n    dataStore = dataStoreModule;\r\n    dataStore.setCurrentUser(currentUser);\r\n    logger.info('Data store initialized');\r\n  } catch (error) {\r\n    logger.warn('DataStore not available', { error: error.message, stack: error.stack });\r\n  }\r\n}\r\n\r\n// Enhanced save functions with database sync\r\nasync function saveUserDataToDatabase() {\r\n  if (!currentUser || !dataStore) {\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const userData = {\r\n      username: currentUser,\r\n      email: users[currentUser]?.email || null,\r\n      preferences: {\r\n        age: users[currentUser]?.personalData?.age,\r\n        weight: users[currentUser]?.personalData?.weight,\r\n        height: users[currentUser]?.personalData?.height,\r\n        sex: users[currentUser]?.personalData?.sex,\r\n        goals: users[currentUser]?.goals,\r\n        baselineLifts: users[currentUser]?.baselineLifts,\r\n        workoutSchedule: users[currentUser]?.workoutSchedule,\r\n      },\r\n      sessions: users[currentUser]?.data?.sessions || [],\r\n      sleepSessions: users[currentUser]?.data?.sleepData || [],\r\n      stravaActivities: users[currentUser]?.data?.stravaData || [],\r\n    };\r\n\r\n    await dataStore.save('user_data', userData);\r\n    logger.info('User data synced to database');\r\n  } catch (error) {\r\n    logger.error('Failed to sync user data to database', { error: error.message, stack: error.stack });\r\n    showError(null, 'Failed to sync data to database');\r\n  }\r\n}\r\n\r\n// Strava Integration Functions\r\nfunction checkStravaConnection() {\r\n  const accessToken = localStorage.getItem('strava_access_token');\r\n  const refreshToken = localStorage.getItem('strava_refresh_token');\r\n  const expiresAt = localStorage.getItem('strava_token_expires');\r\n  const athleteId = localStorage.getItem('strava_athlete_id');\r\n\r\n  const statusDiv = document.getElementById('stravaStatus');\r\n  const connectBtn = document.getElementById('stravaConnectBtn');\r\n  const disconnectBtn = document.getElementById('stravaDisconnectBtn');\r\n  const syncBtn = document.getElementById('stravaSyncBtn');\r\n\r\n  if (!accessToken || !refreshToken || !expiresAt) {\r\n    // Not connected\r\n    statusDiv.className = 'device-status disconnected';\r\n    statusDiv.innerHTML = '<p>‚ùå Not connected to Strava</p>';\r\n    connectBtn.style.display = 'inline-block';\r\n    disconnectBtn.style.display = 'none';\r\n    syncBtn.style.display = 'none';\r\n    return;\r\n  }\r\n\r\n  const now = Date.now() / 1000;\r\n  const expires = parseInt(expiresAt);\r\n\r\n  if (now >= expires) {\r\n    // Token expired, try to refresh\r\n    refreshStravaToken();\r\n    return;\r\n  }\r\n\r\n  // Connected and token is valid\r\n  statusDiv.className = 'device-status connected';\r\n  statusDiv.innerHTML = `\r\n        <p>‚úÖ Connected to Strava</p>\r\n        <div class=\"device-info\">\r\n            <h5>Athlete ID: ${athleteId || 'Unknown'}</h5>\r\n            <p>Token expires: ${new Date(expires * 1000).toLocaleString()}</p>\r\n        </div>\r\n    `;\r\n  connectBtn.style.display = 'none';\r\n  disconnectBtn.style.display = 'inline-block';\r\n  syncBtn.style.display = 'inline-block';\r\n}\r\n\r\nfunction resolveStravaConfig() {\r\n  const integrations = window.configLoader?.get?.('integrations') || {};\r\n  const strava = integrations.strava || {};\r\n  const fallbackRedirect = `${window.location.origin}/auth/strava/callback`;\r\n  return {\r\n    clientId: strava.clientId || '',\r\n    redirectUri: strava.redirectUri || fallbackRedirect,\r\n    scope: strava.scope || 'read,activity:read',\r\n  };\r\n}\r\n\r\nfunction ensureStravaConfig(config) {\r\n  if (!config.clientId) {\r\n    throw new Error('Strava integration requires configuration. Contact your administrator.');\r\n  }\r\n}\r\n\r\nfunction _connectToStrava() {\r\n  try {\r\n    const config = resolveStravaConfig();\r\n    ensureStravaConfig(config);\r\n    const encodedRedirect = encodeURIComponent(config.redirectUri);\r\n    const encodedScope = encodeURIComponent(config.scope);\r\n    const state = `ignite_fitness_${Date.now()}`;\r\n    const stravaAuthUrl = `https://www.strava.com/oauth/authorize?client_id=${encodeURIComponent(config.clientId)}&redirect_uri=${encodedRedirect}&response_type=code&scope=${encodedScope}&state=${state}`;\r\n    window.location.href = stravaAuthUrl;\r\n  } catch (error) {\r\n    logger.error('Failed to start Strava OAuth flow', { error: error.message, stack: error.stack });\r\n    showError(\r\n      null,\r\n      error.message || 'Strava integration requires configuration. Contact your administrator.'\r\n    );\r\n  }\r\n}\r\n\r\nfunction disconnectFromStrava() {\r\n  // Clear all Strava tokens\r\n  localStorage.removeItem('strava_access_token');\r\n  localStorage.removeItem('strava_refresh_token');\r\n  localStorage.removeItem('strava_token_expires');\r\n  localStorage.removeItem('strava_athlete_id');\r\n\r\n  // Update UI\r\n  checkStravaConnection();\r\n  showSuccess('Disconnected from Strava');\r\n}\r\n\r\nasync function refreshStravaToken() {\r\n  const refreshToken = localStorage.getItem('strava_refresh_token');\r\n  if (!refreshToken) {\r\n    checkStravaConnection();\r\n    return;\r\n  }\r\n\r\n  try {\r\n    const response = await fetch('/.netlify/functions/strava-proxy', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({\r\n        action: 'refresh_token',\r\n        refreshToken,\r\n      }),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error('Token refresh failed');\r\n    }\r\n\r\n    const data = await response.json();\r\n\r\n    // Update tokens\r\n    localStorage.setItem('strava_access_token', data.access_token);\r\n    localStorage.setItem('strava_refresh_token', data.refresh_token);\r\n    localStorage.setItem('strava_token_expires', data.expires_at);\r\n\r\n    checkStravaConnection();\r\n  } catch (error) {\r\n    logger.error('Token refresh failed', { error: error.message, stack: error.stack });\r\n    // Clear invalid tokens\r\n    disconnectFromStrava();\r\n  }\r\n}\r\n\r\nasync function _syncStravaData() {\r\n  const statusDiv = document.getElementById('stravaStatus');\r\n  const syncBtn = document.getElementById('stravaSyncBtn');\r\n\r\n  // Show loading state\r\n  statusDiv.className = 'device-status loading';\r\n  statusDiv.innerHTML = '<p>üîÑ Syncing Strava activities...</p>';\r\n  syncBtn.disabled = true;\r\n\r\n  try {\r\n    const accessToken = localStorage.getItem('strava_access_token');\r\n    if (!accessToken) {\r\n      throw new Error('No access token available');\r\n    }\r\n\r\n    // Fetch recent activities\r\n    const response = await fetch('https://www.strava.com/api/v3/athlete/activities?per_page=50', {\r\n      headers: {\r\n        Authorization: `Bearer ${accessToken}`,\r\n      },\r\n    });\r\n\r\n    if (!response.ok) {\r\n      if (response.status === 401) {\r\n        // Token expired, try to refresh\r\n        await refreshStravaToken();\r\n        // TODO: Implement syncStravaData function\r\n        // return syncStravaData();\r\n      }\r\n      throw new Error(`Failed to fetch activities: ${response.status}`);\r\n    }\r\n\r\n    const activities = await response.json();\r\n\r\n    // Process and store activities\r\n    const processedActivities = activities.map(activity => ({\r\n      stravaId: activity.id,\r\n      name: activity.name,\r\n      type: activity.type,\r\n      distance: activity.distance,\r\n      movingTime: activity.moving_time,\r\n      elapsedTime: activity.elapsed_time,\r\n      totalElevationGain: activity.total_elevation_gain,\r\n      startDate: activity.start_date,\r\n      timezone: activity.timezone,\r\n      averageSpeed: activity.average_speed,\r\n      maxSpeed: activity.max_speed,\r\n      averageHeartrate: activity.average_heartrate,\r\n      maxHeartrate: activity.max_heartrate,\r\n      calories: activity.calories,\r\n      payload: activity,\r\n    }));\r\n\r\n    // Save to user data\r\n    if (!users[currentUser]) {\r\n      users[currentUser] = {};\r\n    }\r\n    if (!users[currentUser].data) {\r\n      users[currentUser].data = {};\r\n    }\r\n    users[currentUser].data.stravaData = processedActivities;\r\n    saveUserData();\r\n\r\n    // Sync to database\r\n    await saveUserDataToDatabase();\r\n\r\n    // Update UI\r\n    statusDiv.className = 'device-status connected';\r\n    statusDiv.innerHTML = `\r\n            <p>‚úÖ Synced ${activities.length} activities from Strava</p>\r\n            <div class=\"device-info\">\r\n                <h5>Latest Activity: ${activities[0]?.name || 'None'}</h5>\r\n                <p>Last sync: ${new Date().toLocaleString()}</p>\r\n            </div>\r\n        `;\r\n\r\n    showSuccess(`Synced ${activities.length} activities from Strava`);\r\n  } catch (error) {\r\n    logger.error('Strava sync failed', { error: error.message, stack: error.stack });\r\n    statusDiv.className = 'device-status disconnected';\r\n    statusDiv.innerHTML = `<p>‚ùå Sync failed: ${error.message}</p>`;\r\n    showError(null, `Strava sync failed: ${error.message}`);\r\n  } finally {\r\n    syncBtn.disabled = false;\r\n  }\r\n}\r\n\r\nfunction _toggleAIChat() {\r\n  const chatContainer = document.getElementById('aiChatContainer');\r\n  const chatToggle = document.getElementById('aiChatToggle');\r\n\r\n  if (chatContainer.classList.contains('hidden')) {\r\n    chatContainer.classList.remove('hidden');\r\n    chatToggle.textContent = 'Close AI Coach';\r\n    chatToggle.style.background = '#e53e3e';\r\n  } else {\r\n    chatContainer.classList.add('hidden');\r\n    chatToggle.textContent = 'ü§ñ AI Coach';\r\n    chatToggle.style.background = '#4299e1';\r\n  }\r\n}\r\n\r\nfunction sendToAI() {\r\n  const input = document.getElementById('aiChatInput');\r\n  const message = input.value.trim();\r\n\r\n  if (!message) {\r\n    return;\r\n  }\r\n\r\n  // Add user message to chat\r\n  addMessageToChat(message, 'user');\r\n  input.value = '';\r\n\r\n  // Show typing indicator\r\n  showTypingIndicator();\r\n\r\n  // Process with AI\r\n  if (contextAwareAI) {\r\n    contextAwareAI\r\n      .processUserInput(message)\r\n      .then(response => {\r\n        hideTypingIndicator();\r\n        addMessageToChat(response, 'ai');\r\n      })\r\n      .catch(error => {\r\n        hideTypingIndicator();\r\n        addMessageToChat('Sorry, I encountered an error. Please try again.', 'ai');\r\n        logger.error('AI Error', { error: error.message, stack: error.stack });\r\n      });\r\n  } else {\r\n    hideTypingIndicator();\r\n    addMessageToChat('AI system is not available. Please try again later.', 'ai');\r\n  }\r\n}\r\n\r\nfunction addMessageToChat(message, sender) {\r\n  const messagesContainer = document.getElementById('aiChatMessages');\r\n  const messageDiv = document.createElement('div');\r\n  messageDiv.className = `ai-chat-message ${sender}`;\r\n  messageDiv.textContent = message;\r\n\r\n  messagesContainer.appendChild(messageDiv);\r\n  messagesContainer.scrollTop = messagesContainer.scrollHeight;\r\n}\r\n\r\nfunction showTypingIndicator() {\r\n  const messagesContainer = document.getElementById('aiChatMessages');\r\n  const typingDiv = document.createElement('div');\r\n  typingDiv.className = 'ai-chat-message ai';\r\n  typingDiv.id = 'typing-indicator';\r\n  typingDiv.textContent = 'AI Coach is thinking...';\r\n\r\n  messagesContainer.appendChild(typingDiv);\r\n  messagesContainer.scrollTop = messagesContainer.scrollHeight;\r\n}\r\n\r\nfunction hideTypingIndicator() {\r\n  const typingDiv = document.getElementById('typing-indicator');\r\n  if (typingDiv) {\r\n    typingDiv.remove();\r\n  }\r\n}\r\n\r\nfunction _quickAction(action) {\r\n  const input = document.getElementById('aiChatInput');\r\n\r\n  switch (action) {\r\n    case 'injury':\r\n      input.value = 'I have an injury and need help adjusting my workout';\r\n      break;\r\n    case 'fatigue':\r\n      input.value = \"I'm feeling fatigued and need recovery advice\";\r\n      break;\r\n    case 'goals':\r\n      input.value = 'I want to change my fitness goals';\r\n      break;\r\n    case 'schedule':\r\n      input.value = 'I need help with my workout schedule';\r\n      break;\r\n  }\r\n\r\n  input.focus();\r\n}\r\n\r\n// Handle Enter key in AI chat input - moved to main DOMContentLoaded\r\n"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","id","module","exports","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","o","obj","prop","Object","prototype","hasOwnProperty","call","logger","window","SafeLogger","console","currentUser","isLoggedIn","users","contextAwareAI","seasonalTraining","dataStore","workoutGenerator","patternDetector","moduleCache","Map","loadingStates","async","loadModule","modulePath","className","options","cacheKey","has","get","showLoading","message","hideLoading","overlay","document","createElement","innerHTML","body","appendChild","loadingMessage","loadingPromise","instance","set","delete","error","stack","migrateUserData","currentVersion","storedVersion","localStorage","getItem","info","fromVersion","toVersion","oldUsers","usersData","JSON","parse","migratedUsers","forEach","username","user","version","password","athleteName","personalData","goals","workoutSchedule","sessions","preferences","lastSync","Date","now","createdAt","toISOString","updatedAt","setItem","stringify","accessToken","refreshToken","expiresAt","athleteId","stravaData","access_token","refresh_token","expires_at","parseInt","athlete_id","last_updated","removeItem","migrateStravaData","oldWorkouts","workouts","migrateWorkoutData","migrateFromV1ToV2","showLoginForm","getElementById","classList","remove","add","showUserDashboard","athleteNameElement","textContent","loadUserData","age","value","weight","height","experience","primary","primaryGoal","querySelector","checked","secondary","secondaryGoal","updateSyncStatus","syncStatus","lastSyncTime","syncDate","toLocaleString","showError","element","style","display","addEventListener","savedUser","savedUsers","aiModule","warn","initializeAI","dataStoreModule","setCurrentUser","initializeDataStore","workoutModule","initializeWorkoutGenerator","patternModule","initializePatternDetector","initializeCoreSystems","path","catch","head","addWorkoutStyles","updateSeasonalPhaseDisplay","checkStravaConnection","_user$data2","recentWorkoutsList","recentSessions","data","slice","length","workoutsHtml","map","session","_session$exercises","date","start_at","toLocaleDateString","duration","exercises","type","join","loadRecentWorkouts","aiInput","key","input","trim","addMessageToChat","messagesContainer","typingDiv","scrollTop","scrollHeight","showTypingIndicator","processUserInput","response","hideTypingIndicator","sendToAI","showSuccess","notification","cssText","setTimeout","phaseInfo","getCurrentPhase","phaseNameElement","phaseProgressElement","details","name","progress","Math","round","phaseProgress","statusDiv","connectBtn","disconnectBtn","syncBtn","expires","refreshStravaToken","fetch","method","headers","action","ok","json","sender","messageDiv"],"sourceRoot":""}