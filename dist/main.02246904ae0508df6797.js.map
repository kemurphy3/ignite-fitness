{"version":3,"file":"main.02246904ae0508df6797.js","mappings":"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","sources":["webpack://ignite-fitness/./js/ lazy referencedExports:  namespace object","webpack://ignite-fitness/webpack/bootstrap","webpack://ignite-fitness/webpack/runtime/hasOwnProperty shorthand","webpack://ignite-fitness/./js/app.js"],"sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = 776;\nmodule.exports = webpackEmptyAsyncContext;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// Performance-Optimized App.js with Code Splitting\n// Heavy modules are loaded dynamically to improve initial load time\n\n// Global variables\nlet currentUser = null;\nlet isLoggedIn = false;\nlet users = {};\nlet contextAwareAI = null;\nlet seasonalTraining = null;\nlet dataStore = null;\nlet workoutGenerator = null;\nlet patternDetector = null;\n\n// Module loading cache\nconst moduleCache = new Map();\nconst loadingStates = new Map();\n\n/**\n * Dynamic module loader with caching and loading states\n * @param {string} modulePath - Path to the module\n * @param {string} className - Class name to instantiate\n * @param {Object} options - Loading options\n * @returns {Promise} Promise resolving to module instance\n */\nasync function loadModule(modulePath, className, options = {}) {\n  const cacheKey = `${modulePath}:${className}`;\n\n  // Return cached instance if available\n  if (moduleCache.has(cacheKey)) {\n    return moduleCache.get(cacheKey);\n  }\n\n  // Check if already loading\n  if (loadingStates.has(cacheKey)) {\n    return loadingStates.get(cacheKey);\n  }\n\n  // Show loading state if specified\n  if (options.showLoading) {\n    showLoading(options.loadingMessage || `Loading ${className}...`);\n  }\n\n  try {\n    // Create loading promise\n    const loadingPromise = (async () => {\n      const module = await import(modulePath);\n      const instance = new module[className]();\n\n      // Cache the instance\n      moduleCache.set(cacheKey, instance);\n\n      return instance;\n    })();\n\n    // Store loading promise\n    loadingStates.set(cacheKey, loadingPromise);\n\n    const instance = await loadingPromise;\n\n    // Clean up loading state\n    loadingStates.delete(cacheKey);\n\n    if (options.showLoading) {\n      hideLoading();\n    }\n\n    return instance;\n  } catch (error) {\n    console.error(`Failed to load module ${modulePath}:`, error);\n    loadingStates.delete(cacheKey);\n\n    if (options.showLoading) {\n      hideLoading();\n    }\n\n    throw error;\n  }\n}\n\n/**\n * Load heavy modules on demand\n */\nasync function _loadHeavyModules() {\n  try {\n    // Load soccer exercises only when needed\n    const soccerExercises = await loadModule(\n      './modules/sports/SoccerExercises.js',\n      'SoccerExercises',\n      { showLoading: true, loadingMessage: 'Loading soccer exercises...' }\n    );\n\n    // Load seasonal programs only when needed\n    const seasonalPrograms = await loadModule(\n      './modules/sports/SeasonalPrograms.js',\n      'SeasonalPrograms',\n      { showLoading: true, loadingMessage: 'Loading seasonal programs...' }\n    );\n\n    return { soccerExercises, seasonalPrograms };\n  } catch (error) {\n    console.error('Failed to load heavy modules:', error);\n    showError(null, 'Failed to load some features. Please refresh the page.');\n    return null;\n  }\n}\n\n/**\n * Preload critical modules in background\n */\nfunction preloadCriticalModules() {\n  // Preload modules that are likely to be needed soon\n  const criticalModules = [\n    { path: './modules/ai/ExpertCoordinator.js', className: 'ExpertCoordinator' },\n    { path: './modules/ui/DashboardRenderer.js', className: 'DashboardRenderer' },\n    { path: './modules/workout/WorkoutGenerator.js', className: 'WorkoutGenerator' },\n  ];\n\n  criticalModules.forEach(({ path, className }) => {\n    loadModule(path, className, { showLoading: false }).catch(error =>\n      console.warn(`Preload failed for ${className}:`, error)\n    );\n  });\n}\n\n// Data migration system\nfunction migrateUserData() {\n  const currentVersion = '2.0';\n  const storedVersion = localStorage.getItem('ignitefitness_data_version');\n\n  if (storedVersion === currentVersion) {\n    return; // No migration needed\n  }\n\n  console.log('Migrating user data from version', storedVersion || '1.0', 'to', currentVersion);\n\n  // Migrate from version 1.0 to 2.0\n  if (!storedVersion || storedVersion === '1.0') {\n    migrateFromV1ToV2();\n  }\n\n  // Set new version\n  localStorage.setItem('ignitefitness_data_version', currentVersion);\n  console.log('Data migration completed');\n}\n\nfunction migrateFromV1ToV2() {\n  try {\n    // Migrate users data structure\n    const oldUsers = localStorage.getItem('ignitefitness_users');\n    if (oldUsers) {\n      const usersData = JSON.parse(oldUsers);\n      const migratedUsers = {};\n\n      Object.keys(usersData).forEach(username => {\n        const user = usersData[username];\n        migratedUsers[username] = {\n          version: '2.0',\n          username,\n          password: user.password,\n          athleteName: user.athleteName,\n          personalData: user.personalData || {},\n          goals: user.goals || {},\n          workoutSchedule: user.workoutSchedule || {},\n          sessions: user.sessions || [],\n          preferences: user.preferences || {},\n          lastSync: user.lastSync || Date.now(),\n          createdAt: user.createdAt || new Date().toISOString(),\n          updatedAt: new Date().toISOString(),\n        };\n      });\n\n      localStorage.setItem('ignitefitness_users', JSON.stringify(migratedUsers));\n    }\n\n    // Migrate other data structures\n    migrateStravaData();\n    migrateWorkoutData();\n  } catch (error) {\n    console.error('Error during data migration:', error);\n    // Continue with app initialization even if migration fails\n  }\n}\n\nfunction migrateStravaData() {\n  // Migrate Strava tokens to new format\n  const accessToken = localStorage.getItem('strava_access_token');\n  const refreshToken = localStorage.getItem('strava_refresh_token');\n  const expiresAt = localStorage.getItem('strava_token_expires');\n  const athleteId = localStorage.getItem('strava_athlete_id');\n\n  if (accessToken && refreshToken) {\n    const stravaData = {\n      access_token: accessToken,\n      refresh_token: refreshToken,\n      expires_at: parseInt(expiresAt) || 0,\n      athlete_id: athleteId,\n      last_updated: Date.now(),\n    };\n\n    localStorage.setItem('ignitefitness_strava_data', JSON.stringify(stravaData));\n\n    // Clean up old keys\n    localStorage.removeItem('strava_access_token');\n    localStorage.removeItem('strava_refresh_token');\n    localStorage.removeItem('strava_token_expires');\n    localStorage.removeItem('strava_athlete_id');\n  }\n}\n\nfunction migrateWorkoutData() {\n  // Migrate any old workout data to new format\n  const oldWorkouts = localStorage.getItem('ignitefitness_workouts');\n  if (oldWorkouts) {\n    try {\n      const workouts = JSON.parse(oldWorkouts);\n      // Convert to new format if needed\n      localStorage.setItem(\n        'ignitefitness_workout_data',\n        JSON.stringify({\n          workouts,\n          version: '2.0',\n          last_updated: Date.now(),\n        })\n      );\n      localStorage.removeItem('ignitefitness_workouts');\n    } catch (error) {\n      console.error('Error migrating workout data:', error);\n    }\n  }\n}\n\n// Standardized data storage functions\nfunction saveUserDataToStorage(userId, data) {\n  if (!users[userId]) {\n    users[userId] = {\n      version: '2.0',\n      username: userId,\n      createdAt: new Date().toISOString(),\n      updatedAt: new Date().toISOString(),\n    };\n  }\n\n  // Merge new data with existing user data\n  users[userId] = {\n    ...users[userId],\n    ...data,\n    updatedAt: new Date().toISOString(),\n  };\n\n  localStorage.setItem('ignitefitness_users', JSON.stringify(users));\n}\n\nfunction _getUserDataFromStorage(userId) {\n  return users[userId] || null;\n}\n\nfunction _saveAppData(key, data) {\n  const appData = {\n    version: '2.0',\n    data,\n    last_updated: Date.now(),\n  };\n  localStorage.setItem(`ignitefitness_${key}`, JSON.stringify(appData));\n}\n\nfunction _getAppData(key) {\n  const stored = localStorage.getItem(`ignitefitness_${key}`);\n  if (stored) {\n    try {\n      const parsed = JSON.parse(stored);\n      return parsed.data;\n    } catch (error) {\n      console.error(`Error parsing app data for ${key}:`, error);\n      return null;\n    }\n  }\n  return null;\n}\n\n// Initialize when DOM is loaded\ndocument.addEventListener('DOMContentLoaded', () => {\n  console.log('Ignite Fitness App Starting...');\n\n  // Run data migration first\n  migrateUserData();\n\n  // Check if user is already logged in\n  const savedUser = localStorage.getItem('ignitefitness_current_user');\n  if (savedUser) {\n    currentUser = savedUser;\n    isLoggedIn = true;\n  }\n\n  // Load users from localStorage\n  const savedUsers = localStorage.getItem('ignitefitness_users');\n  if (savedUsers) {\n    try {\n      users = JSON.parse(savedUsers);\n    } catch (error) {\n      console.error('Error parsing saved users:', error);\n      users = {};\n    }\n  }\n\n  // Initialize core systems with dynamic loading\n  initializeCoreSystems();\n\n  // Preload critical modules in background\n  preloadCriticalModules();\n\n  // Add workout styles\n  addWorkoutStyles();\n\n  // Show appropriate UI\n  if (isLoggedIn && currentUser) {\n    showUserDashboard();\n    loadUserData();\n    updateSeasonalPhaseDisplay();\n    checkStravaConnection();\n    updateSyncStatus();\n    loadRecentWorkouts();\n  } else {\n    showLoginForm();\n  }\n\n  // Handle Enter key in AI chat input\n  const aiInput = document.getElementById('aiChatInput');\n  if (aiInput) {\n    aiInput.addEventListener('keypress', e => {\n      if (e.key === 'Enter') {\n        sendToAI();\n      }\n    });\n  }\n\n  console.log('Ignite Fitness App Ready!');\n});\n\n// Simple hash function for password hashing\nfunction simpleHash(str) {\n  let hash = 0;\n  if (str.length === 0) {\n    return hash;\n  }\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i);\n    hash = (hash << 5) - hash + char;\n    hash = hash & hash;\n  }\n  return Math.abs(hash).toString(16);\n}\n\n// Authentication Functions\nfunction _login() {\n  const username = document.getElementById('loginUsername').value;\n  const password = document.getElementById('loginPassword').value;\n  const errorDiv = document.getElementById('loginError');\n\n  if (!username || !password) {\n    showError(errorDiv, 'Please enter both username and password');\n    return;\n  }\n\n  // Check if user exists and verify password hash\n  if (users[username] && users[username].passwordHash) {\n    const passwordHash = simpleHash(password);\n    if (users[username].passwordHash === passwordHash) {\n      currentUser = username;\n      isLoggedIn = true;\n      localStorage.setItem('ignitefitness_current_user', username);\n      localStorage.setItem('ignitefitness_login_time', Date.now().toString());\n      showSuccess('Login successful!');\n      showUserDashboard();\n      loadUserData();\n    } else {\n      showError(errorDiv, 'Invalid username or password');\n    }\n  } else {\n    showError(errorDiv, 'User not found. Please register first.');\n  }\n}\n\nfunction _register() {\n  const username = document.getElementById('regUsername').value;\n  const password = document.getElementById('regPassword').value;\n  const confirmPassword = document.getElementById('regConfirmPassword').value;\n  const athleteName = document.getElementById('regAthleteName').value;\n  const errorDiv = document.getElementById('registerError');\n\n  if (!username || !password || !athleteName) {\n    showError(errorDiv, 'Please fill in all fields');\n    return;\n  }\n\n  if (password !== confirmPassword) {\n    showError(errorDiv, 'Passwords do not match');\n    return;\n  }\n\n  if (users[username]) {\n    showError(errorDiv, 'Username already exists');\n    return;\n  }\n\n  if (password.length < 6) {\n    showError(errorDiv, 'Password must be at least 6 characters long');\n    return;\n  }\n\n  // Create new user with hashed password\n  users[username] = {\n    passwordHash: simpleHash(password),\n    athleteName,\n    personalData: {},\n    goals: {},\n    wearableSettings: {},\n    workoutPlan: null,\n    data: {\n      workouts: [],\n      soccerSessions: [],\n      recoveryData: [],\n      stravaData: [],\n      sleepData: [],\n    },\n    createdAt: Date.now(),\n    lastLogin: null,\n  };\n\n  // Save users\n  localStorage.setItem('ignitefitness_users', JSON.stringify(users));\n\n  // Auto-login after registration\n  currentUser = username;\n  isLoggedIn = true;\n  localStorage.setItem('ignitefitness_current_user', username);\n  showSuccess('Registration successful! Welcome to Ignite Fitness!');\n  showUserDashboard();\n  hideRegisterForm();\n  loadUserData();\n}\n\nfunction _resetPassword() {\n  const username = document.getElementById('resetUsername').value;\n  const athleteName = document.getElementById('resetAthleteName').value;\n  const newPassword = document.getElementById('newPassword').value;\n  const confirmPassword = document.getElementById('confirmNewPassword').value;\n  const errorDiv = document.getElementById('resetError');\n\n  if (!username || !athleteName || !newPassword || !confirmPassword) {\n    showError(errorDiv, 'Please fill in all fields');\n    return;\n  }\n\n  if (newPassword !== confirmPassword) {\n    showError(errorDiv, 'Passwords do not match');\n    return;\n  }\n\n  if (newPassword.length < 6) {\n    showError(errorDiv, 'Password must be at least 6 characters long');\n    return;\n  }\n\n  // Verify user exists and athlete name matches\n  if (users[username] && users[username].athleteName === athleteName) {\n    // Update password hash\n    users[username].passwordHash = simpleHash(newPassword);\n    users[username].lastPasswordReset = Date.now();\n\n    // Save updated users\n    localStorage.setItem('ignitefitness_users', JSON.stringify(users));\n\n    showSuccess('Password reset successfully! Please login with your new password.');\n    hidePasswordReset();\n  } else {\n    showError(errorDiv, 'Invalid username or athlete name');\n  }\n}\n\n// UI Functions\nfunction showLoginForm() {\n  document.getElementById('loginForm').classList.remove('hidden');\n  document.getElementById('userDashboard').classList.add('hidden');\n}\n\nfunction showUserDashboard() {\n  document.getElementById('loginForm').classList.add('hidden');\n  document.getElementById('userDashboard').classList.remove('hidden');\n\n  // Update athlete name display\n  const athleteNameElement = document.getElementById('currentAthleteName');\n  if (athleteNameElement && users[currentUser]) {\n    athleteNameElement.textContent = users[currentUser].athleteName || currentUser;\n  }\n}\n\nfunction _showPasswordReset() {\n  document.getElementById('loginForm').classList.add('hidden');\n  document.getElementById('passwordResetForm').classList.remove('hidden');\n}\n\nfunction hidePasswordReset() {\n  document.getElementById('passwordResetForm').classList.add('hidden');\n  document.getElementById('loginForm').classList.remove('hidden');\n}\n\nfunction _showRegisterForm() {\n  document.getElementById('loginForm').classList.add('hidden');\n  document.getElementById('registerForm').classList.remove('hidden');\n}\n\nfunction hideRegisterForm() {\n  document.getElementById('registerForm').classList.add('hidden');\n}\n\nfunction _hideLoginForm() {\n  document.getElementById('loginForm').classList.add('hidden');\n}\n\n// Tab Functions\nfunction _showTab(tabName, clickedButton) {\n  // Hide all tab contents\n  document.querySelectorAll('.tab-content').forEach(tab => {\n    tab.classList.add('hidden');\n  });\n\n  // Remove active class from all tab buttons\n  document.querySelectorAll('.tab-btn').forEach(btn => {\n    btn.classList.remove('active');\n  });\n\n  // Show selected tab content\n  const selectedTab = document.getElementById(tabName);\n  if (selectedTab) {\n    selectedTab.classList.remove('hidden');\n  }\n\n  // Add active class to clicked button\n  if (clickedButton) {\n    clickedButton.classList.add('active');\n  }\n}\n\n// Data Functions\nfunction loadUserData() {\n  if (!currentUser || !users[currentUser]) {\n    return;\n  }\n\n  const user = users[currentUser];\n\n  // Load personal data\n  if (user.personalData) {\n    if (user.personalData.age) {\n      document.getElementById('age').value = user.personalData.age;\n    }\n    if (user.personalData.weight) {\n      document.getElementById('weight').value = user.personalData.weight;\n    }\n    if (user.personalData.height) {\n      document.getElementById('height').value = user.personalData.height;\n    }\n    if (user.personalData.experience) {\n      document.getElementById('experience').value = user.personalData.experience;\n    }\n  }\n\n  // Load goals\n  if (user.goals) {\n    if (user.goals.primary) {\n      const primaryGoal = document.querySelector(\n        `input[name=\"primaryGoal\"][value=\"${user.goals.primary}\"]`\n      );\n      if (primaryGoal) {\n        primaryGoal.checked = true;\n      }\n    }\n    if (user.goals.secondary) {\n      const secondaryGoal = document.querySelector(\n        `input[name=\"secondaryGoal\"][value=\"${user.goals.secondary}\"]`\n      );\n      if (secondaryGoal) {\n        secondaryGoal.checked = true;\n      }\n    }\n  }\n}\n\nfunction saveUserData() {\n  if (!currentUser) {\n    return;\n  }\n  saveUserDataToStorage(currentUser, users[currentUser] || {});\n}\n\nasync function _savePersonalInfo() {\n  const saveButton = document.querySelector('button[onclick=\"savePersonalInfo()\"]');\n\n  try {\n    if (!currentUser) {\n      showError(null, 'Please log in first');\n      return;\n    }\n\n    const age = document.getElementById('age').value;\n    const weight = document.getElementById('weight').value;\n    const height = document.getElementById('height').value;\n    const experience = document.getElementById('experience').value;\n\n    // Validate input values\n    if (!age || !weight || !height || !experience) {\n      showError(null, 'Please fill in all fields');\n      return;\n    }\n\n    if (isNaN(age) || age < 13 || age > 100) {\n      showError(null, 'Please enter a valid age (13-100)');\n      return;\n    }\n\n    if (isNaN(weight) || weight < 30 || weight > 300) {\n      showError(null, 'Please enter a valid weight (30-300 kg)');\n      return;\n    }\n\n    if (isNaN(height) || height < 100 || height > 250) {\n      showError(null, 'Please enter a valid height (100-250 cm)');\n      return;\n    }\n\n    // Show loading state\n    setButtonLoading(saveButton, true, 'Saving...');\n\n    const personalData = {\n      age: parseInt(age),\n      weight: parseFloat(weight),\n      height: parseInt(height),\n      experience,\n    };\n\n    if (!users[currentUser]) {\n      users[currentUser] = {};\n    }\n\n    users[currentUser].personalData = personalData;\n    saveUserData();\n\n    // Sync to database\n    await saveUserDataToDatabase();\n\n    showSuccess('Personal information saved!');\n  } catch (error) {\n    handleError(error, 'savePersonalInfo');\n  } finally {\n    setButtonLoading(saveButton, false);\n  }\n}\n\nasync function _saveGoals() {\n  const saveButton = document.querySelector('button[onclick=\"saveGoals()\"]');\n\n  try {\n    if (!currentUser) {\n      showError(null, 'Please log in first');\n      return;\n    }\n\n    const primaryGoal = document.querySelector('input[name=\"primaryGoal\"]:checked')?.value;\n    const secondaryGoal = document.querySelector('input[name=\"secondaryGoal\"]:checked')?.value;\n\n    if (!primaryGoal) {\n      showError(null, 'Please select a primary goal');\n      return;\n    }\n\n    // Show loading state\n    setButtonLoading(saveButton, true, 'Saving...');\n\n    const goals = {\n      primary: primaryGoal,\n      secondary: secondaryGoal,\n    };\n\n    if (!users[currentUser]) {\n      users[currentUser] = {};\n    }\n\n    users[currentUser].goals = goals;\n    saveUserData();\n\n    // Sync to database\n    await saveUserDataToDatabase();\n\n    showSuccess('Goals saved!');\n  } catch (error) {\n    handleError(error, 'saveGoals');\n  } finally {\n    setButtonLoading(saveButton, false);\n  }\n}\n\n// Workout Generator Functions\nasync function initializeWorkoutGenerator() {\n  try {\n    const workoutModule = await loadModule(\n      './modules/workout/WorkoutGenerator.js',\n      'WorkoutGenerator'\n    );\n    workoutGenerator = workoutModule;\n    console.log('Workout generator initialized');\n  } catch (error) {\n    console.warn('WorkoutGenerator not available:', error);\n  }\n}\n\nfunction buildUserProfile() {\n  const user = users[currentUser];\n  if (!user) {\n    return {};\n  }\n\n  return {\n    goals: user.goals || {},\n    experience: user.personalData?.experience || 'beginner',\n    personalData: user.personalData || {},\n    currentPhase: seasonalTraining?.getCurrentPhase()?.phase || 'off-season',\n    recentWorkouts: user.data?.sessions || [],\n    preferences: {\n      preferredTimes: [],\n      favoriteExercises: [],\n      intensityPreference: 'moderate',\n      sessionLength: 'medium',\n      restDayPattern: {},\n    },\n  };\n}\n\nfunction displayGeneratedWorkout(workout) {\n  const workoutPlanDiv = document.getElementById('workoutPlan');\n  if (!workoutPlanDiv) {\n    return;\n  }\n\n  const html = `\n        <div class=\"workout-plan\">\n            <h3>Generated Workout Plan</h3>\n            <div class=\"workout-info\">\n                <p><strong>Type:</strong> ${workout.type}</p>\n                <p><strong>Focus:</strong> ${workout.focus}</p>\n                <p><strong>Duration:</strong> ${workout.duration} minutes</p>\n            </div>\n            \n            <div class=\"workout-section\">\n                <h4>Warmup (${workout.warmup.duration} minutes)</h4>\n                <ul>\n                    ${workout.warmup.exercises\n                      .map(\n                        ex => `\n                        <li><strong>${ex.name}:</strong> ${ex.duration} minutes - ${ex.description}</li>\n                    `\n                      )\n                      .join('')}\n                </ul>\n            </div>\n            \n            <div class=\"workout-section\">\n                <h4>Main Exercises</h4>\n                <div class=\"exercises-list\">\n                    ${workout.exercises\n                      .map(\n                        (ex, index) => `\n                        <div class=\"exercise-item\">\n                            <h5>${index + 1}. ${ex.name}</h5>\n                            <div class=\"exercise-details\">\n                                <span><strong>Sets:</strong> ${ex.sets}</span>\n                                <span><strong>Reps:</strong> ${ex.reps}</span>\n                                <span><strong>Weight:</strong> ${ex.weight} lbs</span>\n                                <span><strong>RPE:</strong> ${ex.rpe}/10</span>\n                                <span><strong>Rest:</strong> ${ex.rest}s</span>\n                            </div>\n                            ${ex.notes ? `<p class=\"exercise-notes\">${ex.notes}</p>` : ''}\n                        </div>\n                    `\n                      )\n                      .join('')}\n                </div>\n            </div>\n            \n            <div class=\"workout-section\">\n                <h4>Cooldown (${workout.cooldown.duration} minutes)</h4>\n                <ul>\n                    ${workout.cooldown.exercises\n                      .map(\n                        ex => `\n                        <li><strong>${ex.name}:</strong> ${ex.duration} minutes - ${ex.description}</li>\n                    `\n                      )\n                      .join('')}\n                </ul>\n            </div>\n            \n            ${\n              workout.notes\n                ? `\n                <div class=\"workout-notes\">\n                    <h4>Notes</h4>\n                    <p>${workout.notes}</p>\n                </div>\n            `\n                : ''\n            }\n        </div>\n    `;\n\n  workoutPlanDiv.innerHTML = html;\n}\n\n// Add CSS for workout display\nfunction addWorkoutStyles() {\n  const style = document.createElement('style');\n  style.textContent = `\n        .workout-plan {\n            background: #f7fafc;\n            border: 1px solid #e2e8f0;\n            border-radius: 8px;\n            padding: 20px;\n            margin: 20px 0;\n        }\n        \n        .workout-info {\n            background: white;\n            padding: 15px;\n            border-radius: 6px;\n            margin: 15px 0;\n            border-left: 4px solid #4299e1;\n        }\n        \n        .workout-section {\n            margin: 20px 0;\n        }\n        \n        .workout-section h4 {\n            color: #2d3748;\n            margin-bottom: 10px;\n            padding-bottom: 5px;\n            border-bottom: 2px solid #e2e8f0;\n        }\n        \n        .exercises-list {\n            display: flex;\n            flex-direction: column;\n            gap: 15px;\n        }\n        \n        .exercise-item {\n            background: white;\n            border: 1px solid #e2e8f0;\n            border-radius: 6px;\n            padding: 15px;\n        }\n        \n        .exercise-item h5 {\n            margin: 0 0 10px 0;\n            color: #2d3748;\n        }\n        \n        .exercise-details {\n            display: flex;\n            flex-wrap: wrap;\n            gap: 15px;\n            margin: 10px 0;\n        }\n        \n        .exercise-details span {\n            background: #edf2f7;\n            padding: 4px 8px;\n            border-radius: 4px;\n            font-size: 14px;\n        }\n        \n        .exercise-notes {\n            margin: 10px 0 0 0;\n            font-style: italic;\n            color: #4a5568;\n            font-size: 14px;\n        }\n        \n        .workout-notes {\n            background: #fff5f5;\n            border: 1px solid #fed7d7;\n            border-radius: 6px;\n            padding: 15px;\n            margin: 15px 0;\n        }\n        \n        .workout-notes h4 {\n            color: #742a2a;\n            margin: 0 0 10px 0;\n        }\n        \n        .workout-notes p {\n            margin: 0;\n            color: #742a2a;\n        }\n    `;\n  document.head.appendChild(style);\n}\n\n/**\n * Load soccer exercises when needed\n */\nasync function _loadSoccerExercises() {\n  try {\n    const soccerModule = await loadModule(\n      './modules/sports/SoccerExercises.js',\n      'SoccerExercises',\n      { showLoading: true, loadingMessage: 'Loading soccer exercises...' }\n    );\n    return soccerModule;\n  } catch (error) {\n    console.error('Failed to load soccer exercises:', error);\n    showError(null, 'Soccer exercises not available. Please refresh the page.');\n    return null;\n  }\n}\n\n/**\n * Load seasonal programs when needed\n */\nasync function _loadSeasonalPrograms() {\n  try {\n    const seasonalModule = await loadModule(\n      './modules/sports/SeasonalPrograms.js',\n      'SeasonalPrograms',\n      { showLoading: true, loadingMessage: 'Loading seasonal programs...' }\n    );\n    return seasonalModule;\n  } catch (error) {\n    console.error('Failed to load seasonal programs:', error);\n    showError(null, 'Seasonal programs not available. Please refresh the page.');\n    return null;\n  }\n}\n\n// Pattern Detector Functions\nasync function initializePatternDetector() {\n  try {\n    const patternModule = await loadModule('./modules/ai/PatternDetector.js', 'PatternDetector');\n    patternDetector = patternModule;\n    console.log('Pattern detector initialized');\n  } catch (error) {\n    console.warn('PatternDetector not available:', error);\n  }\n}\n\nfunction analyzeUserPatterns() {\n  if (!currentUser || !patternDetector) {\n    return;\n  }\n\n  const user = users[currentUser];\n  if (!user) {\n    return;\n  }\n\n  try {\n    const userProfile = buildUserProfile();\n    const analysis = patternDetector.analyzePatterns(user.data || {}, userProfile);\n\n    // Store analysis results\n    if (!user.analysis) {\n      user.analysis = {};\n    }\n    user.analysis.patterns = analysis.patterns;\n    user.analysis.insights = analysis.insights;\n    user.analysis.recommendations = analysis.recommendations;\n\n    // Save updated user data\n    saveUserData();\n\n    console.log('Pattern analysis completed:', analysis);\n    return analysis;\n  } catch (error) {\n    console.error('Pattern analysis failed:', error);\n    return null;\n  }\n}\n\nfunction displayPatternInsights() {\n  if (!currentUser || !patternDetector) {\n    return;\n  }\n\n  const user = users[currentUser];\n  if (!user?.analysis) {\n    return;\n  }\n\n  const insights = user.analysis.insights || [];\n  const recommendations = user.analysis.recommendations || [];\n\n  // Create insights display\n  const insightsHtml = `\n        <div class=\"pattern-insights\">\n            <h3>üìä Training Insights</h3>\n            ${\n              insights.length > 0\n                ? `\n                <div class=\"insights-list\">\n                    ${insights\n                      .map(\n                        insight => `\n                        <div class=\"insight-item ${insight.priority}\">\n                            <h4>${insight.type.charAt(0).toUpperCase() + insight.type.slice(1)}</h4>\n                            <p>${insight.message}</p>\n                        </div>\n                    `\n                      )\n                      .join('')}\n                </div>\n            `\n                : '<p>No insights available yet. Complete more workouts to see patterns.</p>'\n            }\n            \n            ${\n              recommendations.length > 0\n                ? `\n                <h3>üí° Recommendations</h3>\n                <div class=\"recommendations-list\">\n                    ${recommendations\n                      .map(\n                        rec => `\n                        <div class=\"recommendation-item\">\n                            <h4>${rec.type.charAt(0).toUpperCase() + rec.type.slice(1)}</h4>\n                            <p><strong>${rec.message}</strong></p>\n                            <p class=\"action\">Action: ${rec.action}</p>\n                        </div>\n                    `\n                      )\n                      .join('')}\n                </div>\n            `\n                : ''\n            }\n        </div>\n    `;\n\n  // Find a place to display insights (could be in a modal or dedicated section)\n  const insightsContainer = document.getElementById('patternInsights');\n  if (insightsContainer) {\n    insightsContainer.innerHTML = insightsHtml;\n  } else {\n    // Create a temporary display\n    const tempDiv = document.createElement('div');\n    tempDiv.innerHTML = insightsHtml;\n    tempDiv.className = 'pattern-insights-modal';\n    document.body.appendChild(tempDiv);\n\n    // Auto-remove after 10 seconds\n    setTimeout(() => {\n      if (tempDiv.parentNode) {\n        tempDiv.parentNode.removeChild(tempDiv);\n      }\n    }, 10000);\n  }\n}\n\n// Add pattern analysis to workout completion\nfunction _onWorkoutCompleted(sessionData) {\n  if (!currentUser) {\n    return;\n  }\n\n  // Add session to user data\n  if (!users[currentUser].data) {\n    users[currentUser].data = {};\n  }\n  if (!users[currentUser].data.sessions) {\n    users[currentUser].data.sessions = [];\n  }\n\n  users[currentUser].data.sessions.push(sessionData);\n  saveUserData();\n\n  // Trigger pattern analysis\n  setTimeout(() => {\n    analyzeUserPatterns();\n  }, 1000);\n}\n\n// UI Component Functions\nfunction updateSyncStatus() {\n  const syncStatus = document.getElementById('syncStatus');\n  const lastSync = document.getElementById('lastSync');\n\n  if (syncStatus && lastSync) {\n    const lastSyncTime = localStorage.getItem('ignitefitness_last_sync');\n    if (lastSyncTime) {\n      const syncDate = new Date(parseInt(lastSyncTime));\n      lastSync.textContent = `Last sync: ${syncDate.toLocaleString()}`;\n      syncStatus.textContent = '‚úÖ Synced';\n    } else {\n      lastSync.textContent = 'Last sync: Never';\n      syncStatus.textContent = 'üîÑ Syncing...';\n    }\n  }\n}\n\nfunction _manualSync() {\n  if (!currentUser) {\n    return;\n  }\n\n  const syncStatus = document.getElementById('syncStatus');\n  if (syncStatus) {\n    syncStatus.textContent = 'üîÑ Syncing...';\n  }\n\n  saveUserDataToDatabase()\n    .then(() => {\n      updateSyncStatus();\n      showSuccess('Data synced successfully!');\n    })\n    .catch(error => {\n      console.error('Sync failed:', error);\n      showError(null, 'Sync failed. Please try again.');\n      if (syncStatus) {\n        syncStatus.textContent = '‚ùå Sync Failed';\n      }\n    });\n}\n\nfunction _startWorkout() {\n  showSuccess('Workout logging will be implemented in the full version!');\n}\n\nfunction _logQuickWorkout() {\n  showSuccess('Quick workout logging will be implemented in the full version!');\n}\n\nfunction _viewProgress() {\n  // Show pattern insights\n  displayPatternInsights();\n  showSuccess('Progress analysis completed!');\n}\n\nfunction updateWorkoutPlanGeneration() {\n  const sessionType = document.getElementById('sessionType')?.value || 'Upper Body';\n  const duration = parseInt(document.getElementById('workoutDuration')?.value) || 60;\n\n  // Update the generateWorkoutPlan function to use these values\n  if (currentUser && workoutGenerator) {\n    const userProfile = buildUserProfile();\n\n    try {\n      const workout = workoutGenerator.generateWorkout(userProfile, sessionType, duration);\n      displayGeneratedWorkout(workout);\n      showSuccess('Workout plan generated successfully!');\n    } catch (error) {\n      console.error('Workout generation failed:', error);\n      showError(null, 'Failed to generate workout plan');\n    }\n  }\n}\n\n// Override the original generateWorkoutPlan function\nfunction _generateWorkoutPlan() {\n  updateWorkoutPlanGeneration();\n}\n\n// Load recent workouts\nfunction loadRecentWorkouts() {\n  if (!currentUser) {\n    return;\n  }\n\n  const user = users[currentUser];\n  const recentWorkoutsList = document.getElementById('recentWorkoutsList');\n\n  if (!recentWorkoutsList) {\n    return;\n  }\n\n  const sessions = user?.data?.sessions || [];\n  const recentSessions = sessions.slice(0, 5); // Last 5 sessions\n\n  if (recentSessions.length === 0) {\n    recentWorkoutsList.innerHTML = '<p>No recent workouts found. Start your first workout!</p>';\n    return;\n  }\n\n  const workoutsHtml = recentSessions\n    .map(session => {\n      const date = new Date(session.start_at).toLocaleDateString();\n      const duration = session.duration || 'Unknown';\n      const exercises = session.exercises?.length || 0;\n\n      return `\n            <div class=\"workout-item\">\n                <div class=\"workout-info\">\n                    <h6>${session.type || 'Workout'}</h6>\n                    <p>${date}</p>\n                </div>\n                <div class=\"workout-stats\">\n                    <span>${duration} min</span>\n                    <span>${exercises} exercises</span>\n                </div>\n            </div>\n        `;\n    })\n    .join('');\n\n  recentWorkoutsList.innerHTML = workoutsHtml;\n}\n\nfunction _logout() {\n  currentUser = null;\n  isLoggedIn = false;\n  localStorage.removeItem('ignitefitness_current_user');\n  showLoginForm();\n  showSuccess('Logged out successfully!');\n}\n\n// Utility Functions\nfunction showError(element, message) {\n  if (element) {\n    element.textContent = message;\n    element.style.display = 'block';\n  }\n}\n\n// Enhanced error handling with user-friendly messages\nfunction handleError(error, context = '') {\n  console.error(`Error in ${context}:`, error);\n\n  let userMessage = 'An unexpected error occurred. Please try again.';\n\n  // Provide more specific error messages based on error type\n  if (error.name === 'TypeError') {\n    userMessage = 'A data error occurred. Please refresh the page and try again.';\n  } else if (error.name === 'ReferenceError') {\n    userMessage = 'A system error occurred. Please refresh the page.';\n  } else if (error.message.includes('fetch')) {\n    userMessage = 'Network error. Please check your connection and try again.';\n  } else if (error.message.includes('JSON')) {\n    userMessage = 'Data format error. Please refresh the page.';\n  } else if (error.message.includes('localStorage')) {\n    userMessage = 'Storage error. Please clear your browser data and try again.';\n  } else if (error.message.includes('permission')) {\n    userMessage = 'Permission denied. Please check your browser settings.';\n  } else if (error.message.includes('timeout')) {\n    userMessage = 'Request timed out. Please try again.';\n  } else if (error.message.includes('unauthorized')) {\n    userMessage = 'Authentication required. Please log in again.';\n  } else if (error.message.includes('not found')) {\n    userMessage = 'Resource not found. Please refresh the page.';\n  } else if (error.message.includes('server')) {\n    userMessage = 'Server error. Please try again later.';\n  }\n\n  // Show error notification\n  showErrorNotification(userMessage, 'error');\n\n  return userMessage;\n}\n\n// Show error notification\nfunction showErrorNotification(message, type = 'error') {\n  // Remove existing notifications\n  const existing = document.getElementById('error-notification');\n  if (existing) {\n    existing.remove();\n  }\n\n  const notification = document.createElement('div');\n  notification.id = 'error-notification';\n  notification.className = `notification ${type}`;\n  notification.style.cssText = `\n        position: fixed;\n        top: 20px;\n        right: 20px;\n        background: ${type === 'error' ? '#e53e3e' : '#68d391'};\n        color: white;\n        padding: 15px 20px;\n        border-radius: 8px;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n        z-index: 10000;\n        max-width: 400px;\n        font-weight: 500;\n        animation: slideIn 0.3s ease;\n    `;\n\n  notification.innerHTML = `\n        <div style=\"display: flex; align-items: center; gap: 10px;\">\n            <span style=\"font-size: 20px;\">${type === 'error' ? '‚ùå' : '‚úÖ'}</span>\n            <span>${message}</span>\n            <button onclick=\"this.parentElement.parentElement.remove()\" style=\"\n                background: none;\n                border: none;\n                color: white;\n                font-size: 18px;\n                cursor: pointer;\n                margin-left: auto;\n            \">√ó</button>\n        </div>\n    `;\n\n  document.body.appendChild(notification);\n\n  // Auto-remove after 5 seconds\n  setTimeout(() => {\n    if (notification.parentElement) {\n      notification.remove();\n    }\n  }, 5000);\n}\n\n// Add CSS animation for notifications\nif (!document.getElementById('notification-styles')) {\n  const style = document.createElement('style');\n  style.id = 'notification-styles';\n  style.textContent = `\n        @keyframes slideIn {\n            from { transform: translateX(100%); opacity: 0; }\n            to { transform: translateX(0); opacity: 1; }\n        }\n        .notification {\n            animation: slideIn 0.3s ease;\n        }\n        .loading-spinner {\n            display: inline-block;\n            width: 20px;\n            height: 20px;\n            border: 3px solid rgba(255,255,255,.3);\n            border-radius: 50%;\n            border-top-color: #fff;\n            animation: spin 1s ease-in-out infinite;\n        }\n        @keyframes spin {\n            to { transform: rotate(360deg); }\n        }\n        .loading-overlay {\n            position: fixed;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: rgba(0,0,0,0.5);\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            z-index: 10000;\n        }\n        .loading-content {\n            background: white;\n            padding: 30px;\n            border-radius: 10px;\n            text-align: center;\n            box-shadow: 0 4px 20px rgba(0,0,0,0.3);\n        }\n    `;\n  document.head.appendChild(style);\n}\n\n// Loading state management\nfunction showLoading(message = 'Loading...') {\n  // Remove existing loading overlay\n  hideLoading();\n\n  const overlay = document.createElement('div');\n  overlay.id = 'loading-overlay';\n  overlay.className = 'loading-overlay';\n  overlay.innerHTML = `\n        <div class=\"loading-content\">\n            <div class=\"loading-spinner\"></div>\n            <p style=\"margin: 15px 0 0 0; color: #2d3748; font-weight: 500;\">${message}</p>\n        </div>\n    `;\n\n  document.body.appendChild(overlay);\n}\n\nfunction hideLoading() {\n  const overlay = document.getElementById('loading-overlay');\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\n// Enhanced button loading state\nfunction setButtonLoading(button, loading = true, text = 'Loading...') {\n  if (!button) {\n    return;\n  }\n\n  if (loading) {\n    button.disabled = true;\n    button.dataset.originalText = button.textContent;\n    button.innerHTML = `<div class=\"loading-spinner\" style=\"margin-right: 8px;\"></div>${text}`;\n  } else {\n    button.disabled = false;\n    button.textContent = button.dataset.originalText || 'Submit';\n    delete button.dataset.originalText;\n  }\n}\n\nfunction showSuccess(message) {\n  // Create or update success notification\n  let notification = document.getElementById('success-notification');\n  if (!notification) {\n    notification = document.createElement('div');\n    notification.id = 'success-notification';\n    notification.style.cssText = `\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            background: #68d391;\n            color: white;\n            padding: 15px 20px;\n            border-radius: 5px;\n            z-index: 1000;\n            display: none;\n        `;\n    document.body.appendChild(notification);\n  }\n\n  notification.textContent = message;\n  notification.style.display = 'block';\n\n  // Hide after 3 seconds\n  setTimeout(() => {\n    notification.style.display = 'none';\n  }, 3000);\n}\n\n/**\n * Initialize core systems with dynamic loading\n */\nasync function initializeCoreSystems() {\n  try {\n    // Initialize AI system\n    await initializeAI();\n\n    // Initialize data store\n    await initializeDataStore();\n\n    // Initialize workout generator\n    await initializeWorkoutGenerator();\n\n    // Initialize pattern detector\n    await initializePatternDetector();\n\n    console.log('Core systems initialized successfully');\n  } catch (error) {\n    console.error('Failed to initialize core systems:', error);\n    showError(null, 'Some features may not be available. Please refresh the page.');\n  }\n}\n\n// AI System Functions\nasync function initializeAI() {\n  try {\n    const aiModule = await loadModule('./modules/ai/ContextAwareAI.js', 'ContextAwareAI');\n    contextAwareAI = aiModule;\n    console.log('AI system initialized');\n  } catch (error) {\n    console.warn('ContextAwareAI not available:', error);\n  }\n}\n\n// Seasonal Training Functions\nasync function _initializeSeasonalTraining() {\n  try {\n    const seasonalModule = await loadModule(\n      './modules/sports/SeasonalTrainingSystem.js',\n      'SeasonalTrainingSystem'\n    );\n    seasonalTraining = seasonalModule;\n    seasonalTraining.initialize();\n    console.log('Seasonal training system initialized');\n  } catch (error) {\n    console.warn('SeasonalTrainingSystem not available:', error);\n  }\n}\n\nfunction updateSeasonalPhaseDisplay() {\n  if (!seasonalTraining) {\n    return;\n  }\n\n  const phaseInfo = seasonalTraining.getCurrentPhase();\n  const phaseNameElement = document.getElementById('currentPhaseName');\n  const phaseProgressElement = document.getElementById('phaseProgress');\n\n  if (phaseNameElement) {\n    phaseNameElement.textContent = phaseInfo.details.name;\n  }\n\n  if (phaseProgressElement) {\n    const progress = Math.round(phaseInfo.phaseProgress * 100);\n    phaseProgressElement.textContent = `${progress}% Complete`;\n  }\n}\n\nfunction _showPhaseModal() {\n  if (!seasonalTraining) {\n    return;\n  }\n\n  const modal = document.getElementById('phaseModal');\n  const phaseDetails = document.getElementById('phaseDetails');\n  const phaseInfo = seasonalTraining.getCurrentPhase();\n\n  if (modal && phaseDetails) {\n    phaseDetails.innerHTML = generatePhaseDetailsHTML(phaseInfo);\n    modal.classList.remove('hidden');\n  }\n}\n\nfunction closePhaseModal() {\n  const modal = document.getElementById('phaseModal');\n  if (modal) {\n    modal.classList.add('hidden');\n  }\n}\n\nfunction generatePhaseDetailsHTML(phaseInfo) {\n  const { details } = phaseInfo;\n  const recommendations = seasonalTraining.getPhaseRecommendations();\n  const upcomingGames = seasonalTraining.getUpcomingGames(3);\n\n  let html = `\n        <div class=\"phase-detail-item\">\n            <h4>Current Phase: ${details.name}</h4>\n            <p><strong>Duration:</strong> ${details.duration}</p>\n            <p><strong>Focus:</strong> ${details.focus}</p>\n            <p><strong>Volume:</strong> ${details.volume}</p>\n            <p><strong>Intensity:</strong> ${details.intensity}</p>\n            <p><strong>Frequency:</strong> ${details.frequency}</p>\n        </div>\n        \n        <div class=\"phase-detail-item\">\n            <h4>Phase Priorities</h4>\n            <ul class=\"phase-priorities\">\n                ${details.priorities.map(priority => `<li>${priority}</li>`).join('')}\n            </ul>\n        </div>\n        \n        <div class=\"phase-detail-item\">\n            <h4>Training Adjustments</h4>\n            <p><strong>Volume Multiplier:</strong> ${details.adjustments.volumeMultiplier}x</p>\n            <p><strong>Intensity Multiplier:</strong> ${details.adjustments.intensityMultiplier}x</p>\n            <p><strong>Recovery Days:</strong> ${details.adjustments.recoveryDays} days</p>\n            <p><strong>Max Session Duration:</strong> ${details.adjustments.maxSessionDuration} minutes</p>\n        </div>\n    `;\n\n  if (recommendations.length > 0) {\n    html += `\n            <div class=\"phase-detail-item\">\n                <h4>Recommendations</h4>\n                ${recommendations\n                  .map(\n                    rec => `\n                    <p><strong>${rec.category}:</strong> ${rec.message}</p>\n                `\n                  )\n                  .join('')}\n            </div>\n        `;\n  }\n\n  if (upcomingGames.length > 0) {\n    html += `\n            <div class=\"phase-detail-item\">\n                <h4>Upcoming Games</h4>\n                <div class=\"game-schedule\">\n                    ${upcomingGames\n                      .map(\n                        game => `\n                        <div class=\"game-item\">\n                            <div>\n                                <div class=\"game-date\">${game.date.toLocaleDateString()}</div>\n                                <div class=\"game-opponent\">vs ${game.opponent}</div>\n                            </div>\n                            <div class=\"game-type\">${game.type}</div>\n                        </div>\n                    `\n                      )\n                      .join('')}\n                </div>\n            </div>\n        `;\n  }\n\n  return html;\n}\n\nfunction _changePhase() {\n  const phases = ['off-season', 'pre-season', 'in-season', 'playoffs'];\n  const currentPhase = seasonalTraining.getCurrentPhase().phase;\n  const currentIndex = phases.indexOf(currentPhase);\n  const nextIndex = (currentIndex + 1) % phases.length;\n  const nextPhase = phases[nextIndex];\n\n  if (seasonalTraining.setPhase(nextPhase)) {\n    updateSeasonalPhaseDisplay();\n    showSuccess(`Phase changed to ${seasonalTraining.phases[nextPhase].name}`);\n    closePhaseModal();\n  }\n}\n\nfunction _addGame() {\n  const opponent = prompt('Enter opponent name:');\n  if (!opponent) {\n    return;\n  }\n\n  const dateStr = prompt('Enter game date (YYYY-MM-DD):');\n  if (!dateStr) {\n    return;\n  }\n\n  const gameDate = new Date(dateStr);\n  if (isNaN(gameDate.getTime())) {\n    showError(null, 'Invalid date format');\n    return;\n  }\n\n  const type = prompt('Enter game type (regular/playoff/championship):') || 'regular';\n  const location = prompt('Enter location (home/away):') || 'home';\n\n  seasonalTraining.addGame({\n    opponent,\n    date: gameDate,\n    type,\n    location,\n  });\n\n  showSuccess('Game added to schedule');\n  closePhaseModal();\n}\n\n// Data Store Functions\nasync function initializeDataStore() {\n  try {\n    const dataStoreModule = await loadModule('./modules/data/DataStore.js', 'DataStore');\n    dataStore = dataStoreModule;\n    dataStore.setCurrentUser(currentUser);\n    console.log('Data store initialized');\n  } catch (error) {\n    console.warn('DataStore not available:', error);\n  }\n}\n\n// Enhanced save functions with database sync\nasync function saveUserDataToDatabase() {\n  if (!currentUser || !dataStore) {\n    return;\n  }\n\n  try {\n    const userData = {\n      username: currentUser,\n      email: users[currentUser]?.email || null,\n      preferences: {\n        age: users[currentUser]?.personalData?.age,\n        weight: users[currentUser]?.personalData?.weight,\n        height: users[currentUser]?.personalData?.height,\n        sex: users[currentUser]?.personalData?.sex,\n        goals: users[currentUser]?.goals,\n        baselineLifts: users[currentUser]?.baselineLifts,\n        workoutSchedule: users[currentUser]?.workoutSchedule,\n      },\n      sessions: users[currentUser]?.data?.sessions || [],\n      sleepSessions: users[currentUser]?.data?.sleepData || [],\n      stravaActivities: users[currentUser]?.data?.stravaData || [],\n    };\n\n    await dataStore.save('user_data', userData);\n    console.log('User data synced to database');\n  } catch (error) {\n    console.error('Failed to sync user data to database:', error);\n    showError(null, 'Failed to sync data to database');\n  }\n}\n\n// Strava Integration Functions\nfunction checkStravaConnection() {\n  const accessToken = localStorage.getItem('strava_access_token');\n  const refreshToken = localStorage.getItem('strava_refresh_token');\n  const expiresAt = localStorage.getItem('strava_token_expires');\n  const athleteId = localStorage.getItem('strava_athlete_id');\n\n  const statusDiv = document.getElementById('stravaStatus');\n  const connectBtn = document.getElementById('stravaConnectBtn');\n  const disconnectBtn = document.getElementById('stravaDisconnectBtn');\n  const syncBtn = document.getElementById('stravaSyncBtn');\n\n  if (!accessToken || !refreshToken || !expiresAt) {\n    // Not connected\n    statusDiv.className = 'device-status disconnected';\n    statusDiv.innerHTML = '<p>‚ùå Not connected to Strava</p>';\n    connectBtn.style.display = 'inline-block';\n    disconnectBtn.style.display = 'none';\n    syncBtn.style.display = 'none';\n    return;\n  }\n\n  const now = Date.now() / 1000;\n  const expires = parseInt(expiresAt);\n\n  if (now >= expires) {\n    // Token expired, try to refresh\n    refreshStravaToken();\n    return;\n  }\n\n  // Connected and token is valid\n  statusDiv.className = 'device-status connected';\n  statusDiv.innerHTML = `\n        <p>‚úÖ Connected to Strava</p>\n        <div class=\"device-info\">\n            <h5>Athlete ID: ${athleteId || 'Unknown'}</h5>\n            <p>Token expires: ${new Date(expires * 1000).toLocaleString()}</p>\n        </div>\n    `;\n  connectBtn.style.display = 'none';\n  disconnectBtn.style.display = 'inline-block';\n  syncBtn.style.display = 'inline-block';\n}\n\nfunction resolveStravaConfig() {\n  const integrations = window.configLoader?.get?.('integrations') || {};\n  const strava = integrations.strava || {};\n  const fallbackRedirect = `${window.location.origin}/auth/strava/callback`;\n  return {\n    clientId: strava.clientId || '',\n    redirectUri: strava.redirectUri || fallbackRedirect,\n    scope: strava.scope || 'read,activity:read',\n  };\n}\n\nfunction ensureStravaConfig(config) {\n  if (!config.clientId) {\n    throw new Error('Strava integration requires configuration. Contact your administrator.');\n  }\n}\n\nfunction _connectToStrava() {\n  try {\n    const config = resolveStravaConfig();\n    ensureStravaConfig(config);\n    const encodedRedirect = encodeURIComponent(config.redirectUri);\n    const encodedScope = encodeURIComponent(config.scope);\n    const state = `ignite_fitness_${Date.now()}`;\n    const stravaAuthUrl = `https://www.strava.com/oauth/authorize?client_id=${encodeURIComponent(config.clientId)}&redirect_uri=${encodedRedirect}&response_type=code&scope=${encodedScope}&state=${state}`;\n    window.location.href = stravaAuthUrl;\n  } catch (error) {\n    console.error('Failed to start Strava OAuth flow:', error);\n    showError(\n      null,\n      error.message || 'Strava integration requires configuration. Contact your administrator.'\n    );\n  }\n}\n\nfunction disconnectFromStrava() {\n  // Clear all Strava tokens\n  localStorage.removeItem('strava_access_token');\n  localStorage.removeItem('strava_refresh_token');\n  localStorage.removeItem('strava_token_expires');\n  localStorage.removeItem('strava_athlete_id');\n\n  // Update UI\n  checkStravaConnection();\n  showSuccess('Disconnected from Strava');\n}\n\nasync function refreshStravaToken() {\n  const refreshToken = localStorage.getItem('strava_refresh_token');\n  if (!refreshToken) {\n    checkStravaConnection();\n    return;\n  }\n\n  try {\n    const response = await fetch('/.netlify/functions/strava-proxy', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        action: 'refresh_token',\n        refreshToken,\n      }),\n    });\n\n    if (!response.ok) {\n      throw new Error('Token refresh failed');\n    }\n\n    const data = await response.json();\n\n    // Update tokens\n    localStorage.setItem('strava_access_token', data.access_token);\n    localStorage.setItem('strava_refresh_token', data.refresh_token);\n    localStorage.setItem('strava_token_expires', data.expires_at);\n\n    checkStravaConnection();\n  } catch (error) {\n    console.error('Token refresh failed:', error);\n    // Clear invalid tokens\n    disconnectFromStrava();\n  }\n}\n\nasync function _syncStravaData() {\n  const statusDiv = document.getElementById('stravaStatus');\n  const syncBtn = document.getElementById('stravaSyncBtn');\n\n  // Show loading state\n  statusDiv.className = 'device-status loading';\n  statusDiv.innerHTML = '<p>üîÑ Syncing Strava activities...</p>';\n  syncBtn.disabled = true;\n\n  try {\n    const accessToken = localStorage.getItem('strava_access_token');\n    if (!accessToken) {\n      throw new Error('No access token available');\n    }\n\n    // Fetch recent activities\n    const response = await fetch('https://www.strava.com/api/v3/athlete/activities?per_page=50', {\n      headers: {\n        Authorization: `Bearer ${accessToken}`,\n      },\n    });\n\n    if (!response.ok) {\n      if (response.status === 401) {\n        // Token expired, try to refresh\n        await refreshStravaToken();\n        return syncStravaData();\n      }\n      throw new Error(`Failed to fetch activities: ${response.status}`);\n    }\n\n    const activities = await response.json();\n\n    // Process and store activities\n    const processedActivities = activities.map(activity => ({\n      stravaId: activity.id,\n      name: activity.name,\n      type: activity.type,\n      distance: activity.distance,\n      movingTime: activity.moving_time,\n      elapsedTime: activity.elapsed_time,\n      totalElevationGain: activity.total_elevation_gain,\n      startDate: activity.start_date,\n      timezone: activity.timezone,\n      averageSpeed: activity.average_speed,\n      maxSpeed: activity.max_speed,\n      averageHeartrate: activity.average_heartrate,\n      maxHeartrate: activity.max_heartrate,\n      calories: activity.calories,\n      payload: activity,\n    }));\n\n    // Save to user data\n    if (!users[currentUser]) {\n      users[currentUser] = {};\n    }\n    if (!users[currentUser].data) {\n      users[currentUser].data = {};\n    }\n    users[currentUser].data.stravaData = processedActivities;\n    saveUserData();\n\n    // Sync to database\n    await saveUserDataToDatabase();\n\n    // Update UI\n    statusDiv.className = 'device-status connected';\n    statusDiv.innerHTML = `\n            <p>‚úÖ Synced ${activities.length} activities from Strava</p>\n            <div class=\"device-info\">\n                <h5>Latest Activity: ${activities[0]?.name || 'None'}</h5>\n                <p>Last sync: ${new Date().toLocaleString()}</p>\n            </div>\n        `;\n\n    showSuccess(`Synced ${activities.length} activities from Strava`);\n  } catch (error) {\n    console.error('Strava sync failed:', error);\n    statusDiv.className = 'device-status disconnected';\n    statusDiv.innerHTML = `<p>‚ùå Sync failed: ${error.message}</p>`;\n    showError(null, `Strava sync failed: ${error.message}`);\n  } finally {\n    syncBtn.disabled = false;\n  }\n}\n\nfunction _toggleAIChat() {\n  const chatContainer = document.getElementById('aiChatContainer');\n  const chatToggle = document.getElementById('aiChatToggle');\n\n  if (chatContainer.classList.contains('hidden')) {\n    chatContainer.classList.remove('hidden');\n    chatToggle.textContent = 'Close AI Coach';\n    chatToggle.style.background = '#e53e3e';\n  } else {\n    chatContainer.classList.add('hidden');\n    chatToggle.textContent = 'ü§ñ AI Coach';\n    chatToggle.style.background = '#4299e1';\n  }\n}\n\nfunction sendToAI() {\n  const input = document.getElementById('aiChatInput');\n  const message = input.value.trim();\n\n  if (!message) {\n    return;\n  }\n\n  // Add user message to chat\n  addMessageToChat(message, 'user');\n  input.value = '';\n\n  // Show typing indicator\n  showTypingIndicator();\n\n  // Process with AI\n  if (contextAwareAI) {\n    contextAwareAI\n      .processUserInput(message)\n      .then(response => {\n        hideTypingIndicator();\n        addMessageToChat(response, 'ai');\n      })\n      .catch(error => {\n        hideTypingIndicator();\n        addMessageToChat('Sorry, I encountered an error. Please try again.', 'ai');\n        console.error('AI Error:', error);\n      });\n  } else {\n    hideTypingIndicator();\n    addMessageToChat('AI system is not available. Please try again later.', 'ai');\n  }\n}\n\nfunction addMessageToChat(message, sender) {\n  const messagesContainer = document.getElementById('aiChatMessages');\n  const messageDiv = document.createElement('div');\n  messageDiv.className = `ai-chat-message ${sender}`;\n  messageDiv.textContent = message;\n\n  messagesContainer.appendChild(messageDiv);\n  messagesContainer.scrollTop = messagesContainer.scrollHeight;\n}\n\nfunction showTypingIndicator() {\n  const messagesContainer = document.getElementById('aiChatMessages');\n  const typingDiv = document.createElement('div');\n  typingDiv.className = 'ai-chat-message ai';\n  typingDiv.id = 'typing-indicator';\n  typingDiv.textContent = 'AI Coach is thinking...';\n\n  messagesContainer.appendChild(typingDiv);\n  messagesContainer.scrollTop = messagesContainer.scrollHeight;\n}\n\nfunction hideTypingIndicator() {\n  const typingDiv = document.getElementById('typing-indicator');\n  if (typingDiv) {\n    typingDiv.remove();\n  }\n}\n\nfunction _quickAction(action) {\n  const input = document.getElementById('aiChatInput');\n\n  switch (action) {\n    case 'injury':\n      input.value = 'I have an injury and need help adjusting my workout';\n      break;\n    case 'fatigue':\n      input.value = \"I'm feeling fatigued and need recovery advice\";\n      break;\n    case 'goals':\n      input.value = 'I want to change my fitness goals';\n      break;\n    case 'schedule':\n      input.value = 'I need help with my workout schedule';\n      break;\n  }\n\n  input.focus();\n}\n\n// Handle Enter key in AI chat input - moved to main DOMContentLoaded\n"],"names":["webpackEmptyAsyncContext","req","Promise","resolve","then","e","Error","code","keys","id","module","exports","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","o","obj","prop","Object","prototype","hasOwnProperty","call","currentUser","isLoggedIn","users","contextAwareAI","seasonalTraining","dataStore","workoutGenerator","patternDetector","moduleCache","Map","loadingStates","async","loadModule","modulePath","className","options","cacheKey","has","get","showLoading","message","hideLoading","overlay","document","createElement","innerHTML","body","appendChild","loadingMessage","loadingPromise","instance","set","delete","error","migrateUserData","storedVersion","localStorage","getItem","oldUsers","usersData","JSON","parse","migratedUsers","forEach","username","user","version","password","athleteName","personalData","goals","workoutSchedule","sessions","preferences","lastSync","Date","now","createdAt","toISOString","updatedAt","setItem","stringify","accessToken","refreshToken","expiresAt","athleteId","stravaData","access_token","refresh_token","expires_at","parseInt","athlete_id","last_updated","removeItem","migrateStravaData","oldWorkouts","workouts","migrateWorkoutData","migrateFromV1ToV2","showLoginForm","getElementById","classList","remove","add","showUserDashboard","athleteNameElement","textContent","loadUserData","age","value","weight","height","experience","primary","primaryGoal","querySelector","checked","secondary","secondaryGoal","updateSyncStatus","syncStatus","lastSyncTime","syncDate","toLocaleString","showError","element","style","display","addEventListener","savedUser","savedUsers","aiModule","initializeAI","dataStoreModule","setCurrentUser","initializeDataStore","workoutModule","initializeWorkoutGenerator","patternModule","initializePatternDetector","initializeCoreSystems","path","catch","head","addWorkoutStyles","updateSeasonalPhaseDisplay","checkStravaConnection","_user$data2","recentWorkoutsList","recentSessions","data","slice","length","workoutsHtml","map","session","_session$exercises","date","start_at","toLocaleDateString","duration","exercises","type","join","loadRecentWorkouts","aiInput","key","input","trim","addMessageToChat","messagesContainer","typingDiv","scrollTop","scrollHeight","showTypingIndicator","processUserInput","response","hideTypingIndicator","sendToAI","showSuccess","notification","cssText","setTimeout","phaseInfo","getCurrentPhase","phaseNameElement","phaseProgressElement","details","name","progress","Math","round","phaseProgress","statusDiv","connectBtn","disconnectBtn","syncBtn","expires","refreshStravaToken","fetch","method","headers","action","ok","json","sender","messageDiv"],"sourceRoot":""}