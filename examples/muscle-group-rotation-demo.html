<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Muscle Group Rotation Implementation Demo</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .demo-section {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .workout-example {
            background: white;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
        }
        .exercise-item {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 4px;
            padding: 8px 12px;
            margin: 5px 0;
        }
        .muscle-groups {
            color: #666;
            font-size: 0.9em;
            font-style: italic;
        }
        .rotation-logic {
            background: #fff3e0;
            border: 1px solid #ff9800;
            border-radius: 4px;
            padding: 12px;
            margin: 10px 0;
        }
        .before-after {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .before, .after {
            padding: 15px;
            border-radius: 8px;
        }
        .before {
            background: #ffebee;
            border: 1px solid #f44336;
        }
        .after {
            background: #e8f5e8;
            border: 1px solid #4caf50;
        }
        .code-block {
            background: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 12px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>üîß Muscle Group Rotation Implementation Demo</h1>
    
    <p>This demonstrates the replacement of random exercise selection with deterministic muscle group rotation logic.</p>
    
    <div class="demo-section">
        <h2>üéØ Problem Solved</h2>
        <div class="before-after">
            <div class="before">
                <h3>‚ùå Before (Random Selection)</h3>
                <ul>
                    <li>Math.random() used for exercise selection</li>
                    <li>Same user state could produce different exercises</li>
                    <li>No muscle group rotation logic</li>
                    <li>Could target same muscles repeatedly</li>
                </ul>
            </div>
            <div class="after">
                <h3>‚úÖ After (Muscle Group Rotation)</h3>
                <ul>
                    <li>Deterministic selection based on user profile</li>
                    <li>Same user state produces same exercise</li>
                    <li>Automatic muscle group rotation</li>
                    <li>Upper body ‚Üí Lower body ‚Üí Upper body</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="demo-section">
        <h2>üîÑ Muscle Group Rotation Logic</h2>
        
        <div class="rotation-logic">
            <h3>How It Works:</h3>
            <ol>
                <li><strong>Check Last Workout:</strong> Analyze muscle groups from previous workout</li>
                <li><strong>Find Different Groups:</strong> Select exercises targeting different muscle groups</li>
                <li><strong>Deterministic Selection:</strong> Use user profile + date for consistent selection</li>
                <li><strong>Fallback:</strong> If no different groups available, use deterministic selection</li>
            </ol>
        </div>

        <h3>Example: Upper Body ‚Üí Lower Body Rotation</h3>
        
        <div class="workout-example">
            <h4>Last Workout (Upper Body):</h4>
            <div class="exercise-item">
                <strong>Bench Press</strong>
                <div class="muscle-groups">Muscle Groups: chest, shoulders, triceps</div>
            </div>
            <div class="exercise-item">
                <strong>Pull-ups</strong>
                <div class="muscle-groups">Muscle Groups: lats, biceps, rhomboids</div>
            </div>
        </div>

        <div class="workout-example">
            <h4>Next Workout (Lower Body - Auto-Selected):</h4>
            <div class="exercise-item">
                <strong>Squats</strong>
                <div class="muscle-groups">Muscle Groups: quadriceps, glutes, hamstrings</div>
            </div>
            <div class="exercise-item">
                <strong>Romanian Deadlifts</strong>
                <div class="muscle-groups">Muscle Groups: hamstrings, glutes</div>
            </div>
        </div>
    </div>

    <div class="demo-section">
        <h2>üîß Technical Implementation</h2>
        
        <h3>Key Methods Added:</h3>
        
        <h4>selectExerciseWithRotation()</h4>
        <div class="code-block">
// Select exercise with muscle group rotation logic
selectExerciseWithRotation(exercises, userProfile, targetMuscleGroup) {
    // Get last workout's muscle groups
    const lastWorkoutMuscleGroups = this.getLastWorkoutMuscleGroups(userProfile);
    
    // Find exercises targeting different muscle groups
    const differentMuscleGroupExercises = exercises.filter(exercise => {
        return !exercise.muscleGroups.some(muscleGroup => 
            lastWorkoutMuscleGroups.includes(muscleGroup)
        );
    });
    
    // Use different muscle groups if available
    if (differentMuscleGroupExercises.length > 0) {
        return this.selectExerciseDeterministically(differentMuscleGroupExercises, userProfile);
    }
    
    // Fallback to deterministic selection
    return this.selectExerciseDeterministically(exercises, userProfile);
}
        </div>

        <h4>selectExerciseDeterministically()</h4>
        <div class="code-block">
// Select exercise deterministically based on user profile
selectExerciseDeterministically(exercises, userProfile) {
    // Create deterministic seed based on user profile
    const seed = this.createDeterministicSeed(userProfile);
    
    // Use seed to select exercise (same seed = same selection)
    const index = seed % exercises.length;
    return exercises[index];
}
        </div>

        <h4>createDeterministicSeed()</h4>
        <div class="code-block">
// Create deterministic seed based on user profile
createDeterministicSeed(userProfile) {
    const userId = userProfile.id || userProfile.username || 'default';
    const experience = userProfile.experience || 'beginner';
    const currentDate = new Date().toDateString(); // Same day = same seed
    
    // Create hash-like value for deterministic selection
    let seed = 0;
    const combinedString = `${userId}-${experience}-${currentDate}`;
    
    for (let i = 0; i < combinedString.length; i++) {
        seed = ((seed << 5) - seed + combinedString.charCodeAt(i)) & 0xffffffff;
    }
    
    return Math.abs(seed);
}
        </div>
    </div>

    <div class="demo-section">
        <h2>üìä Test Results</h2>
        
        <h3>‚úÖ All Tests Passed:</h3>
        <ul>
            <li><strong>Deterministic Selection:</strong> Same user state produces same exercise</li>
            <li><strong>Muscle Group Rotation:</strong> Avoids targeting same muscles as last workout</li>
            <li><strong>Upper/Lower Body Rotation:</strong> Automatically alternates between upper and lower body</li>
            <li><strong>Equipment Fallback:</strong> Falls back to available equipment when needed</li>
            <li><strong>User Differentiation:</strong> Different users get different exercises</li>
        </ul>

        <h3>üß™ Test Examples:</h3>
        <div class="workout-example">
            <strong>Test 1:</strong> Same user state ‚Üí Same exercise selection ‚úÖ<br>
            <strong>Test 2:</strong> After chest workout ‚Üí Selects back exercises ‚úÖ<br>
            <strong>Test 3:</strong> After upper body ‚Üí Selects lower body exercises ‚úÖ<br>
            <strong>Test 4:</strong> Different users ‚Üí Different exercise selections ‚úÖ
        </div>
    </div>

    <div class="demo-section">
        <h2>üéØ Definition of Done - ACHIEVED</h2>
        
        <h3>‚úÖ Requirements Met:</h3>
        <ul>
            <li><strong>selectExercise() checks lastWorkout.muscleGroups before selecting</strong> ‚úÖ</li>
            <li><strong>Upper body workout followed by lower body workout automatically</strong> ‚úÖ</li>
            <li><strong>Same user state + equipment produces same exercise selection</strong> ‚úÖ</li>
        </ul>

        <h3>üîß Files Modified:</h3>
        <ul>
            <li><code>js/training/workout-generator.js</code> - Main implementation</li>
            <li><code>tests/training/workout-generator-rotation.test.js</code> - Test suite</li>
        </ul>

        <h3>üöÄ Benefits:</h3>
        <ul>
            <li><strong>Predictable:</strong> Same user state always produces same exercise</li>
            <li><strong>Balanced:</strong> Automatic muscle group rotation prevents overtraining</li>
            <li><strong>Logical:</strong> Upper body ‚Üí Lower body ‚Üí Upper body progression</li>
            <li><strong>Honest:</strong> No fake randomness, transparent selection logic</li>
        </ul>
    </div>

    <div class="demo-section">
        <h2>üîÑ Next Steps</h2>
        <p>This implementation successfully replaces random exercise selection with:</p>
        <ul>
            <li>‚úÖ Deterministic muscle group rotation</li>
            <li>‚úÖ User history-based selection</li>
            <li>‚úÖ Equipment availability fallback</li>
            <li>‚úÖ Transparent selection logic</li>
        </ul>
        <p><strong>Task 2A is complete and ready for the next phase of fraud prevention implementation.</strong></p>
    </div>
</body>
</html>
