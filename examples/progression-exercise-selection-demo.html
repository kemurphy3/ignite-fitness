<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Progression-Based Exercise Selection Demo</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .demo-section {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .before-after {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .before, .after {
            padding: 15px;
            border-radius: 8px;
        }
        .before {
            background: #ffebee;
            border: 1px solid #f44336;
        }
        .after {
            background: #e8f5e8;
            border: 1px solid #4caf50;
        }
        .code-block {
            background: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 12px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
        }
        .test-results {
            background: #fff3e0;
            border: 1px solid #ff9800;
            border-radius: 4px;
            padding: 12px;
            margin: 10px 0;
        }
        .progression-example {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 4px;
            padding: 12px;
            margin: 10px 0;
        }
        .score-breakdown {
            background: #f3e5f5;
            border: 1px solid #9c27b0;
            border-radius: 4px;
            padding: 12px;
            margin: 10px 0;
        }
        .plateau-example {
            background: #ffcdd2;
            border: 1px solid #c62828;
            border-radius: 4px;
            padding: 12px;
            margin: 10px 0;
        }
        .assistance-example {
            background: #c8e6c9;
            border: 1px solid #2e7d32;
            border-radius: 4px;
            padding: 12px;
            margin: 10px 0;
        }
        .score-high { color: #2e7d32; font-weight: bold; }
        .score-medium { color: #f57c00; font-weight: bold; }
        .score-low { color: #c62828; font-weight: bold; }
    </style>
</head>
<body>
    <h1>üèãÔ∏è Progression-Based Exercise Selection Demo</h1>
    
    <p>This demonstrates the implementation of progression-based exercise selection in the ExerciseAdapter, replacing random selection with intelligent criteria-based recommendations.</p>
    
    <div class="demo-section">
        <h2>üéØ Problem Solved</h2>
        <div class="before-after">
            <div class="before">
                <h3>‚ùå Before (Random Selection)</h3>
                <ul>
                    <li>No consideration of user progression data</li>
                    <li>Same exercises regardless of plateau status</li>
                    <li>No assistance exercise recommendations</li>
                    <li>No rationale for exercise selection</li>
                </ul>
            </div>
            <div class="after">
                <h3>‚úÖ After (Progression-Based Selection)</h3>
                <ul>
                    <li>Uses user's 1RM percentages and progression trends</li>
                    <li>Prioritizes exercises where user is progressing</li>
                    <li>Recommends assistance exercises for plateaus</li>
                    <li>Provides clear selection rationale</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="demo-section">
        <h2>üîß Technical Implementation</h2>
        
        <h3>Key Methods Added:</h3>
        
        <h4>selectExerciseForUser() - Main Selection Method</h4>
        <div class="code-block">
selectExerciseForUser(availableExercises, userProfile, targetMuscleGroup = null) {
    // Get user's progression data
    const progressionData = this.getUserProgressionData(userProfile);
    
    // Score exercises based on progression criteria
    const scoredExercises = candidateExercises.map(exercise => {
        const score = this.calculateProgressionScore(exercise, progressionData, userProfile);
        return {
            exercise: exercise,
            score: score,
            rationale: this.generateSelectionRationale(exercise, score, progressionData)
        };
    });
    
    // Sort by score and select top exercise
    scoredExercises.sort((a, b) => b.score - a.score);
    
    return {
        exercise: selected.exercise,
        rationale: selected.rationale,
        selectionMetadata: { /* detailed selection info */ }
    };
}
        </div>

        <h4>getUserProgressionData() - Progression Analysis</h4>
        <div class="code-block">
getUserProgressionData(userProfile) {
    const progressionData = {
        exerciseProgress: {},
        plateauExercises: [],
        progressingExercises: [],
        averageRPE: 0,
        trainingFrequency: 0
    };
    
    // Analyze last 30 days of training
    // Calculate progression trends
    // Identify plateaued vs progressing exercises
    
    return progressionData;
}
        </div>

        <h4>calculateProgressionScore() - Scoring Algorithm</h4>
        <div class="code-block">
calculateProgressionScore(exercise, progressionData, userProfile) {
    let score = 50; // Base score
    
    // Factor 1: Progression status (40% weight)
    if (trend.status === 'progressing') score += 20;
    else if (trend.status === 'plateau') score -= 10;
    
    // Factor 2: Plateau assistance (30% weight)
    const plateauAssistance = this.getPlateauAssistance(exerciseName, plateauExercises);
    if (plateauAssistance > 0) score += plateauAssistance * 15;
    
    // Factor 3: User experience level (20% weight)
    // Factor 4: Recent performance (10% weight)
    
    return Math.max(0, Math.min(100, score));
}
        </div>
    </div>

    <div class="demo-section">
        <h2>üìä Progression Analysis</h2>
        
        <h3>Progression Detection Algorithm:</h3>
        <ul>
            <li><strong>Recent Sessions:</strong> Last 5 workout sessions</li>
            <li><strong>Older Sessions:</strong> Previous 5 workout sessions</li>
            <li><strong>Trend Calculation:</strong> (recentAvg - olderAvg) / olderAvg</li>
            <li><strong>Thresholds:</strong> >5% = progressing, <5% = plateau, <-5% = regressing</li>
        </ul>

        <div class="progression-example">
            <h4>Example: Bench Press Progression Analysis</h4>
            <p><strong>Recent Sessions (Last 5):</strong> 185lbs, 185lbs, 185lbs, 185lbs, 185lbs</p>
            <p><strong>Older Sessions (Previous 5):</strong> 180lbs, 180lbs, 175lbs, 175lbs, 170lbs</p>
            <p><strong>Recent Average:</strong> 185lbs</p>
            <p><strong>Older Average:</strong> 176lbs</p>
            <p><strong>Trend:</strong> (185 - 176) / 176 = 5.1%</p>
            <p><strong>Status:</strong> <span class="score-high">PROGRESSING</span></p>
        </div>

        <div class="plateau-example">
            <h4>Example: Bench Press Plateau Detection</h4>
            <p><strong>Recent Sessions (Last 5):</strong> 185lbs, 185lbs, 185lbs, 185lbs, 185lbs</p>
            <p><strong>Older Sessions (Previous 5):</strong> 185lbs, 185lbs, 185lbs, 185lbs, 185lbs</p>
            <p><strong>Recent Average:</strong> 185lbs</p>
            <p><strong>Older Average:</strong> 185lbs</p>
            <p><strong>Trend:</strong> (185 - 185) / 185 = 0%</p>
            <p><strong>Status:</strong> <span class="score-low">PLATEAU</span></p>
        </div>
    </div>

    <div class="demo-section">
        <h2>üéØ Scoring Criteria</h2>
        
        <h3>Progression Score Factors:</h3>
        
        <div class="score-breakdown">
            <h4>Factor 1: Progression Status (40% weight)</h4>
            <ul>
                <li><span class="score-high">+20 points:</span> Exercise is progressing (>5% improvement)</li>
                <li><span class="score-medium">+10 points:</span> New exercise (no history)</li>
                <li><span class="score-medium">-10 points:</span> Exercise is plateaued (0-5% change)</li>
                <li><span class="score-low">-15 points:</span> Exercise is regressing (<-5% decline)</li>
            </ul>
        </div>

        <div class="score-breakdown">
            <h4>Factor 2: Plateau Assistance (30% weight)</h4>
            <ul>
                <li><span class="score-high">+15 points:</span> Exercise assists with plateaued movement</li>
                <li><span class="score-medium">0 points:</span> No plateau assistance</li>
            </ul>
        </div>

        <div class="score-breakdown">
            <h4>Factor 3: Experience Level (20% weight)</h4>
            <ul>
                <li><span class="score-low">-15 points:</span> Complex exercise for beginners</li>
                <li><span class="score-medium">-10 points:</span> Simple exercise for advanced users</li>
                <li><span class="score-high">0 points:</span> Appropriate complexity</li>
            </ul>
        </div>

        <div class="score-breakdown">
            <h4>Factor 4: Recent Performance (10% weight)</h4>
            <ul>
                <li><span class="score-high">+5 points:</span> Recently easy (RPE < 6)</li>
                <li><span class="score-medium">0 points:</span> Moderate difficulty (RPE 6-8)</li>
                <li><span class="score-low">-5 points:</span> Recently very hard (RPE > 8)</li>
            </ul>
        </div>
    </div>

    <div class="demo-section">
        <h2>üîÑ Plateau Assistance System</h2>
        
        <h3>Assistance Exercise Mapping:</h3>
        
        <div class="assistance-example">
            <h4>Bench Press Plateau ‚Üí Assistance Exercises</h4>
            <ul>
                <li><strong>Dumbbell Press:</strong> Unilateral training, different stability demands</li>
                <li><strong>Incline Press:</strong> Different angle, targets upper chest</li>
                <li><strong>Close Grip Press:</strong> Tricep focus, different movement pattern</li>
                <li><strong>Dips:</strong> Bodyweight alternative, tricep emphasis</li>
            </ul>
        </div>

        <div class="assistance-example">
            <h4>Squat Plateau ‚Üí Assistance Exercises</h4>
            <ul>
                <li><strong>Front Squat:</strong> Different load placement, core emphasis</li>
                <li><strong>Bulgarian Split Squat:</strong> Unilateral training, stability work</li>
                <li><strong>Paused Squat:</strong> Time under tension, strength development</li>
                <li><strong>Box Squat:</strong> Different movement pattern, power development</li>
            </ul>
        </div>

        <div class="assistance-example">
            <h4>Deadlift Plateau ‚Üí Assistance Exercises</h4>
            <ul>
                <li><strong>Romanian Deadlift:</strong> Hamstring focus, reduced lower back stress</li>
                <li><strong>Trap Bar Deadlift:</strong> More upright torso, different mechanics</li>
                <li><strong>Sumo Deadlift:</strong> Different stance, hip emphasis</li>
                <li><strong>Rack Pull:</strong> Reduced range of motion, overload training</li>
            </ul>
        </div>
    </div>

    <div class="demo-section">
        <h2>üß™ Test Results</h2>
        
        <div class="test-results">
            <h3>‚úÖ All Tests Passed:</h3>
            <ul>
                <li><strong>Progression Detection:</strong> Correctly identifies plateaued vs progressing exercises</li>
                <li><strong>Plateau Assistance:</strong> Recommends appropriate assistance exercises</li>
                <li><strong>Experience Level:</strong> Adjusts complexity based on user level</li>
                <li><strong>Muscle Group Targeting:</strong> Filters exercises by target muscle group</li>
                <li><strong>Selection Rationale:</strong> Provides clear explanation for choices</li>
                <li><strong>Metadata Inclusion:</strong> Returns detailed selection information</li>
            </ul>
        </div>

        <h3>üß™ Test Examples:</h3>
        <div class="progression-example">
            <strong>Test 1:</strong> Bench Press Plateau Detection ‚úÖ<br>
            <strong>Test 2:</strong> Dumbbell Press Assistance Score: 1.0 ‚úÖ<br>
            <strong>Test 3:</strong> Incline Press Assistance Score: 1.0 ‚úÖ<br>
            <strong>Test 4:</strong> Close Grip Press Assistance Score: 1.0 ‚úÖ<br>
            <strong>Test 5:</strong> Dips Assistance Score: 1.0 ‚úÖ<br>
            <strong>Test 6:</strong> Plateau exercises: bench press ‚úÖ<br>
            <strong>Test 7:</strong> Selection rationale provided ‚úÖ
        </div>

        <h3>üìä Score Breakdown Example:</h3>
        <div class="score-breakdown">
            <h4>Dumbbell Press Selection (Bench Press Plateau)</h4>
            <ul>
                <li><strong>Base Score:</strong> 50 points</li>
                <li><strong>New Exercise Bonus:</strong> +10 points</li>
                <li><strong>Plateau Assistance:</strong> +15 points</li>
                <li><strong>Experience Level:</strong> 0 points (appropriate)</li>
                <li><strong>Recent Performance:</strong> 0 points (no history)</li>
                <li><strong>Total Score:</strong> <span class="score-high">75 points</span></li>
            </ul>
        </div>
    </div>

    <div class="demo-section">
        <h2>üéØ Definition of Done - ACHIEVED</h2>
        
        <h3>‚úÖ Requirements Met:</h3>
        <ul>
            <li><strong>selectExerciseForUser() returns {exercise, rationale: "Prioritized due to recent progress"}</strong> ‚úÖ</li>
            <li><strong>Exercises selected based on user.progression data</strong> ‚úÖ</li>
            <li><strong>Users with bench press plateau get recommended assistance exercises</strong> ‚úÖ</li>
        </ul>

        <h3>üîß Files Modified:</h3>
        <ul>
            <li><code>js/modules/workout/ExerciseAdapter.js</code> - Main implementation</li>
        </ul>

        <h3>üöÄ Benefits:</h3>
        <ul>
            <li><strong>Intelligent Selection:</strong> Exercises chosen based on actual progression data</li>
            <li><strong>Plateau Breaking:</strong> Assistance exercises recommended for stuck movements</li>
            <li><strong>Experience Appropriate:</strong> Complexity matched to user level</li>
            <li><strong>Transparent Rationale:</strong> Clear explanation for every selection</li>
            <li><strong>Data-Driven:</strong> Uses 30 days of training history for decisions</li>
        </ul>
    </div>

    <div class="demo-section">
        <h2>üîÑ Impact on User Experience</h2>
        
        <h3>Before vs After:</h3>
        <div class="before-after">
            <div class="before">
                <h4>‚ùå Random Selection</h4>
                <ul>
                    <li>Same exercises regardless of progress</li>
                    <li>No help with plateaus</li>
                    <li>No explanation for choices</li>
                    <li>One-size-fits-all approach</li>
                </ul>
            </div>
            <div class="after">
                <h4>‚úÖ Progression-Based Selection</h4>
                <ul>
                    <li>Exercises matched to progression status</li>
                    <li>Assistance exercises for plateaus</li>
                    <li>Clear rationale for every choice</li>
                    <li>Personalized to user's data</li>
                </ul>
            </div>
        </div>

        <h3>Example User Scenarios:</h3>
        <div class="progression-example">
            <strong>Scenario 1:</strong> User with bench press plateau<br>
            ‚Üí <strong>Selected:</strong> Dumbbell Press<br>
            ‚Üí <strong>Rationale:</strong> "Recommended as assistance exercise for plateaued movement pattern"<br>
            ‚Üí <strong>Score:</strong> 75 (base 50 + new exercise 10 + plateau assistance 15)
        </div>

        <div class="progression-example">
            <strong>Scenario 2:</strong> User with progressing squat<br>
            ‚Üí <strong>Selected:</strong> Squat<br>
            ‚Üí <strong>Rationale:</strong> "Prioritized due to recent progress and optimal difficulty level"<br>
            ‚Üí <strong>Score:</strong> 70 (base 50 + progressing 20)
        </div>

        <div class="progression-example">
            <strong>Scenario 3:</strong> Beginner user<br>
            ‚Üí <strong>Selected:</strong> Machine exercises over complex movements<br>
            ‚Üí <strong>Rationale:</strong> "Selected based on progression data and user experience level"<br>
            ‚Üí <strong>Score:</strong> Adjusted for complexity appropriateness
        </div>
    </div>

    <div class="demo-section">
        <h2>üîÑ Next Steps</h2>
        <p>This implementation successfully adds progression-based exercise selection with:</p>
        <ul>
            <li>‚úÖ Progression trend analysis</li>
            <li>‚úÖ Plateau assistance recommendations</li>
            <li>‚úÖ Experience level considerations</li>
            <li>‚úÖ Clear selection rationale</li>
            <li>‚úÖ Detailed metadata for debugging</li>
        </ul>
        <p><strong>Task 2B is complete and ready for the next phase of fraud prevention implementation.</strong></p>
    </div>
</body>
</html>
